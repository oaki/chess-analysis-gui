{"version":3,"sources":["webpack:///../node_modules/chessground/util.js","webpack:///../node_modules/chessground/board.js","webpack:///../node_modules/chessground/types.js","webpack:///../node_modules/chessground/fen.js","webpack:///../node_modules/chessground/config.js","webpack:///../node_modules/chessground/anim.js","webpack:///../node_modules/chessground/drag.js","webpack:///../node_modules/chessground/draw.js","webpack:///../node_modules/chessground/svg.js","webpack:///../node_modules/@fortawesome/fontawesome-free-solid/faBook.js","webpack:///../node_modules/@fortawesome/fontawesome-free-solid/faCogs.js","webpack:///../node_modules/@fortawesome/fontawesome-free-solid/faInfoCircle.js","webpack:///../node_modules/chessground/chessground.js","webpack:///../node_modules/chessground/api.js","webpack:///../node_modules/chessground/premove.js","webpack:///../node_modules/chessground/explosion.js","webpack:///../node_modules/chessground/state.js","webpack:///../node_modules/chessground/wrap.js","webpack:///../node_modules/chessground/events.js","webpack:///../node_modules/chessground/render.js","webpack:///../node_modules/lodash/throttle.js","webpack:///../node_modules/use-resize-observer/dist/bundle.esm.js"],"names":["Object","defineProperty","exports","value","cg","colors","invRanks","allKeys","_a","Array","prototype","concat","apply","files","map","c","ranks","r","pos2key","pos","key2pos","k","charCodeAt","memo","f","v","ret","undefined","clear","timer","startAt","start","Date","now","cancel","stop","time","opposite","containsX","xs","x","indexOf","distanceSq","pos1","pos2","Math","pow","samePiece","p1","p2","role","color","computeIsTrident","window","navigator","userAgent","posToTranslateBase","asWhite","xFactor","yFactor","posToTranslateAbs","bounds","width","height","posToTranslateRel","translateAbs","el","style","transform","translateRel","percents","left","top","setVisible","visibility","eventPosition","e","clientX","clientY","touches","targetTouches","isRightButton","buttons","button","createEl","tagName","className","document","createElement","raf","requestAnimationFrame","setTimeout","bind","util_1","premove_1","callUserFunction","args","_i","arguments","length","unsetPremove","state","premovable","current","events","unset","unsetPredrop","pd","predroppable","baseMove","orig","dest","pieces","captured","selected","unselect","move","autoCastle","king","origPos","oldRookPos","newRookPos","newKingPos","destPos","rook","tryAutoCastle","lastMove","check","change","baseNewPiece","piece","key","force","dropNewPiece","movable","dests","turnColor","baseUserMove","result","animation","userMove","canMove","holdTime","hold","metadata","premove","ctrlKey","stats","after","isPremovable","default","castle","canPremove","isMovable","setSelected","meta","set","setPremove","free","enabled","cancelMove","toggleOrientation","orientation","draggable","reset","setPieces","setCheck","canDrop","afterNewPiece","predrop","canPredrop","setPredrop","selectSquare","selectable","dragged","select","isDraggable","playPremove","success","playPredrop","validate","drop","getKeyAtDomPos","file","ceil","rank","initial","roles","p","n","b","q","letters","pawn","knight","bishop","queen","read","fen","row","col","fen_1","promoted","nb","toLowerCase","write","letter","y","toUpperCase","join","replace","s","toString","board_1","isObject","o","configure","config","merge","base","extend","drawable","shapes","hasOwnProperty","duration","rookCastle","rank_1","kingStartPos","dests_1","filter","d","__assign","this","assign","t","i","call","util","render","mutation","dom","redraw","makePiece","anim","prevPieces","plan","curP","preP","vector","anims","animedOrigs","fadings","missings","news","prePieces","push","forEach","newP","sort","items","computePlan","isObjectEmpty","alreadyRunning","perf","frequency","step","cur","destroyed","redrawNow","rest","ease","cfg","animate","performance","_","board","draw_1","anim_1","processDrag","origPiece","started","epos","rel","distance","element","found","cgDragging","classList","add","translation","dec","newPiece","removeDragElements","elements","ghost","computeSquareBounds","pieceElementByKey","firstChild","cgKey","nextSibling","preventDefault","position","previouslySelected","eraseOnClick","hadPremove","hadPredrop","stillSelected","squareBounds","centerPiece","autoDistance","originTarget","target","dragNewPiece","end","type","eventPos","deleteOnDropOff","brushes","processDraw","mouseSq","eventBrush","a","shiftKey","altKey","onChange","stopPropagation","brush","sameShape","similar","addShape","isTrident","createElementNS","shapeHash","arrowDests","m","modifiers","pieceHash","lineWidth","scale","renderMarker","marker","setAttributes","id","orient","markerWidth","markerHeight","refX","refY","appendChild","fill","setAttribute","attrs","makeCustomBrush","opacity","round","pos2px","renderSvg","root","curD","autoShapes","shape","hash","fullHash","sc","prevSvgHash","defsEl","keysInDom","getAttribute","syncDefs","hashesInDom","toRemove","elHash","removeChild","baseUrl","size","name","href","renderPiece","shorten","arrowMargin","dx","dy","angle","atan2","xo","cos","yo","sin","stroke","x1","y1","x2","y2","renderArrow","widths","circleWidth","radius","cx","cy","renderCircle","renderShape","syncShapes","module","prefix","iconName","icon","api_1","config_1","state_1","wrap_1","render_1","svg","debounceRedraw","redrawing","Chessground","defaults","redrawAll","prevUnbind","unbind","getBoundingClientRect","relative","viewOnly","visible","skipSvg","bindBoard","bindDocument","drag_1","explosion_1","getFen","cancelPremove","cancelPredrop","explode","keys","setAutoShapes","setShapes","event","destroy","diff","abs","xd","yd","canCastle","mobility","rookFiles","rookFilesOf","setStage","stage","exploding","coordinates","disableContextMenu","resizable","addPieceZIndex","pieceKey","highlight","showDests","showGhost","green","red","blue","yellow","paleBlue","paleGreen","paleRed","paleGrey","types_1","svg_1","renderCoords","elems","textContent","innerHTML","toggle","orientClass","drag","draw","unbindable","eventName","callback","options","addEventListener","removeEventListener","dragOrDraw","withDrag","withDraw","boardEl","onStart","startDragOrDraw","unbinds","body","onmove_1","onend_1","ev","onScroll","passive","isPieceNode","isSquareNode","removeNodes","nodes","posZIndex","z","pieceNameOf","addSquare","squares","klass","pieceAtKey","elPieceName","fading","pMvdset","pMvd","sMvdset","sMvd","posToTranslate","translate","curAnim","curDrag","pDests","computeSquareClasses","samePieces","sameSquares","movedPieces","movedSquares","piecesKeys","cgPiece","remove","cgFading","cgAnimating","zIndex","cn","sk","pop","squareNode","insertBefore","j","pieceName","pieceNode","debounce","func","wait","leading","trailing","TypeError","opts","defaultRef","onResize","onResizeRef","resizeObserverRef","ref","_useState","setSize","previous","ResizeObserver","entries","isArray","entry","newWidth","contentRect","newHeight","newSize","Element","observe","unobserve"],"mappings":"0FACAA,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtD,IAAIC,EAAK,EAAQ,KACjBF,EAAQG,OAAS,CAAC,QAAS,SAC3BH,EAAQI,SAAW,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACzCJ,EAAQK,SAAWC,EAAKC,MAAMC,WAAWC,OAAOC,MAAMJ,EAAIJ,EAAGS,MAAMC,KAAI,SAAUC,GAAK,OAAOX,EAAGY,MAAMF,KAAI,SAAUG,GAAK,OAAOF,EAAIE,SACpIf,EAAQgB,QAAU,SAAUC,GAAO,OAAOjB,EAAQK,QAAQ,EAAIY,EAAI,GAAKA,EAAI,GAAK,IAChFjB,EAAQkB,QAAU,SAAUC,GAAK,MAAO,CAACA,EAAEC,WAAW,GAAK,GAAID,EAAEC,WAAW,GAAK,KAWjFpB,EAAQqB,KAVR,SAAcC,GACV,IAAIC,EACAC,EAAM,WAGN,YAFUC,IAANF,IACAA,EAAID,KACDC,GAGX,OADAC,EAAIE,MAAQ,WAAcH,OAAIE,GACvBD,GAGXxB,EAAQ2B,MAAQ,WACZ,IAAIC,EACJ,MAAO,CACHC,MAAO,WAAcD,EAAUE,KAAKC,OACpCC,OAAQ,WAAcJ,OAAUH,GAChCQ,KAAM,WACF,IAAKL,EACD,OAAO,EACX,IAAIM,EAAOJ,KAAKC,MAAQH,EAExB,OADAA,OAAUH,EACHS,KAInBlC,EAAQmC,SAAW,SAAUtB,GAAK,MAAa,UAANA,EAAgB,QAAU,SAInEb,EAAQoC,UAHR,SAAmBC,EAAIC,GACnB,YAAcb,IAAPY,IAAuC,IAAnBA,EAAGE,QAAQD,IAG1CtC,EAAQwC,WAAa,SAAUC,EAAMC,GACjC,OAAOC,KAAKC,IAAIH,EAAK,GAAKC,EAAK,GAAI,GAAKC,KAAKC,IAAIH,EAAK,GAAKC,EAAK,GAAI,IAExE1C,EAAQ6C,UAAY,SAAUC,EAAIC,GAC9B,OAAOD,EAAGE,OAASD,EAAGC,MAAQF,EAAGG,QAAUF,EAAGE,OAElDjD,EAAQkD,iBAAmB,WAAc,OAAOC,OAAOC,UAAUC,UAAUd,QAAQ,aAAe,GAClG,IAkCIjC,EAlCAgD,EAAqB,SAAUrC,EAAKsC,EAASC,EAASC,GAAW,MAAO,EACvEF,EAAUtC,EAAI,GAAK,EAAI,EAAIA,EAAI,IAAMuC,GACrCD,EAAU,EAAItC,EAAI,GAAKA,EAAI,GAAK,GAAKwC,IAE1CzD,EAAQ0D,kBAAoB,SAAUC,GAClC,IAAIH,EAAUG,EAAOC,MAAQ,EAAGH,EAAUE,EAAOE,OAAS,EAC1D,OAAO,SAAU5C,EAAKsC,GAAW,OAAOD,EAAmBrC,EAAKsC,EAASC,EAASC,KAEtFzD,EAAQ8D,kBAAoB,SAAU7C,EAAKsC,GAAW,OAAOD,EAAmBrC,EAAKsC,EAAS,KAAM,OACpGvD,EAAQ+D,aAAe,SAAUC,EAAI/C,GACjC+C,EAAGC,MAAMC,UAAY,aAAejD,EAAI,GAAK,MAAQA,EAAI,GAAK,OAElEjB,EAAQmE,aAAe,SAAUH,EAAII,GACjCJ,EAAGC,MAAMI,KAAOD,EAAS,GAAK,IAC9BJ,EAAGC,MAAMK,IAAMF,EAAS,GAAK,KAEjCpE,EAAQuE,WAAa,SAAUP,EAAIzC,GAC/ByC,EAAGC,MAAMO,WAAajD,EAAI,UAAY,UAE1CvB,EAAQyE,cAAgB,SAAUC,GAC9B,OAAIA,EAAEC,SAAyB,IAAdD,EAAEC,QACR,CAACD,EAAEC,QAASD,EAAEE,SACrBF,EAAEG,SAAWH,EAAEI,cAAc,GACtB,CAACJ,EAAEI,cAAc,GAAGH,QAASD,EAAEI,cAAc,GAAGF,cAD3D,GAIJ5E,EAAQ+E,cAAgB,SAAUL,GAAK,OAAqB,IAAdA,EAAEM,SAA8B,IAAbN,EAAEO,QACnEjF,EAAQkF,SAAW,SAAUC,EAASC,GAClC,IAAIpB,EAAKqB,SAASC,cAAcH,GAGhC,OAFIC,IACApB,EAAGoB,UAAYA,GACZpB,GAEXhE,EAAQuF,KAAOpC,OAAOqC,uBAAyBrC,OAAOsC,YAAYC,KAAKvC,S,iCC7EvErD,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtD,IAAI0F,EAAS,EAAQ,KACjBC,EAAY,EAAQ,KACxB,SAASC,EAAiBvE,GAEtB,IADA,IAAIwE,EAAO,GACFC,EAAK,EAAGA,EAAKC,UAAUC,OAAQF,IACpCD,EAAKC,EAAK,GAAKC,UAAUD,GAEzBzE,GACAmE,YAAW,WAAc,OAAOnE,EAAEZ,WAAM,EAAQoF,KAAU,GA6ClE,SAASI,EAAaC,GACdA,EAAMC,WAAWC,UACjBF,EAAMC,WAAWC,aAAU5E,EAC3BoE,EAAiBM,EAAMC,WAAWE,OAAOC,QAYjD,SAASC,EAAaL,GAClB,IAAIM,EAAKN,EAAMO,aACXD,EAAGJ,UACHI,EAAGJ,aAAU5E,EACboE,EAAiBY,EAAGH,OAAOC,QAsCnC,SAASI,EAASR,EAAOS,EAAMC,GAC3B,GAAID,IAASC,IAASV,EAAMW,OAAOF,GAC/B,OAAO,EACX,IAAIG,EAAYZ,EAAMW,OAAOD,IACzBV,EAAMW,OAAOD,GAAM5D,QAAUkD,EAAMW,OAAOF,GAAM3D,MAASkD,EAAMW,OAAOD,QAAQpF,EAWlF,OAVIoF,GAAQV,EAAMa,UACdC,EAASd,GACbN,EAAiBM,EAAMG,OAAOY,KAAMN,EAAMC,EAAME,GAzCpD,SAAuBZ,EAAOS,EAAMC,GAChC,IAAKV,EAAMgB,WACP,OAAO,EACX,IAAIC,EAAOjB,EAAMW,OAAOF,GACxB,GAAkB,SAAdQ,EAAKpE,KACL,OAAO,EACX,IAAIqE,EAAU1B,EAAOzE,QAAQ0F,GAC7B,GAAmB,IAAfS,EAAQ,GACR,OAAO,EACX,GAAmB,IAAfA,EAAQ,IAA2B,IAAfA,EAAQ,GAC5B,OAAO,EACX,IACIC,EAAYC,EAAYC,EADxBC,EAAU9B,EAAOzE,QAAQ2F,GAE7B,GAAmB,IAAfY,EAAQ,IAA2B,IAAfA,EAAQ,GAC5BH,EAAa3B,EAAO3E,QAAQ,CAAC,EAAGqG,EAAQ,KACxCE,EAAa5B,EAAO3E,QAAQ,CAAC,EAAGqG,EAAQ,KACxCG,EAAa7B,EAAO3E,QAAQ,CAAC,EAAGqG,EAAQ,SAEvC,IAAmB,IAAfI,EAAQ,IAA2B,IAAfA,EAAQ,GAMjC,OAAO,EALPH,EAAa3B,EAAO3E,QAAQ,CAAC,EAAGqG,EAAQ,KACxCE,EAAa5B,EAAO3E,QAAQ,CAAC,EAAGqG,EAAQ,KACxCG,EAAa7B,EAAO3E,QAAQ,CAAC,EAAGqG,EAAQ,KAI5C,IAAIK,EAAOvB,EAAMW,OAAOQ,GACxB,MAAkB,SAAdI,EAAK1E,cAEFmD,EAAMW,OAAOF,UACbT,EAAMW,OAAOQ,GACpBnB,EAAMW,OAAOU,GAAcJ,EAC3BjB,EAAMW,OAAOS,GAAcG,GACpB,GAUFC,CAAcxB,EAAOS,EAAMC,KAC5BV,EAAMW,OAAOD,GAAQV,EAAMW,OAAOF,UAC3BT,EAAMW,OAAOF,IAExBT,EAAMyB,SAAW,CAAChB,EAAMC,GACxBV,EAAM0B,WAAQpG,EACdoE,EAAiBM,EAAMG,OAAOwB,QACvBf,IAAY,EAGvB,SAASgB,EAAa5B,EAAO6B,EAAOC,EAAKC,GACrC,GAAI/B,EAAMW,OAAOmB,GAAM,CACnB,IAAIC,EAGA,OAAO,SAFA/B,EAAMW,OAAOmB,GAW5B,OAPApC,EAAiBM,EAAMG,OAAO6B,aAAcH,EAAOC,GACnD9B,EAAMW,OAAOmB,GAAOD,EACpB7B,EAAMyB,SAAW,CAACK,GAClB9B,EAAM0B,WAAQpG,EACdoE,EAAiBM,EAAMG,OAAOwB,QAC9B3B,EAAMiC,QAAQC,WAAQ5G,EACtB0E,EAAMmC,UAAY3C,EAAOxD,SAASgE,EAAMmC,YACjC,EAGX,SAASC,EAAapC,EAAOS,EAAMC,GAC/B,IAAI2B,EAAS7B,EAASR,EAAOS,EAAMC,GAMnC,OALI2B,IACArC,EAAMiC,QAAQC,WAAQ5G,EACtB0E,EAAMmC,UAAY3C,EAAOxD,SAASgE,EAAMmC,WACxCnC,EAAMsC,UAAUpC,aAAU5E,GAEvB+G,EAEX,SAASE,EAASvC,EAAOS,EAAMC,GAC3B,GAAI8B,EAAQxC,EAAOS,EAAMC,GAAO,CAC5B,IAAI2B,EAASD,EAAapC,EAAOS,EAAMC,GACvC,GAAI2B,EAAQ,CACR,IAAII,EAAWzC,EAAM0C,KAAK5G,OAC1BgF,EAASd,GACT,IAAI2C,EAAW,CACXC,SAAS,EACTC,QAAS7C,EAAM8C,MAAMD,QACrBJ,SAAUA,GAKd,OAHe,IAAXJ,IACAM,EAAS/B,SAAWyB,GACxB3C,EAAiBM,EAAMiC,QAAQ9B,OAAO4C,MAAOtC,EAAMC,EAAMiC,IAClD,QA6FnB,SAAoB3C,EAAOS,EAAMC,GAC7B,OAAOD,IAASC,GACZsC,EAAahD,EAAOS,IACpBjB,EAAOvD,UAAUwD,EAAUwD,QAAQjD,EAAMW,OAAQF,EAAMT,EAAMC,WAAWiD,QAASxC,GA7F5EyC,CAAWnD,EAAOS,EAAMC,GAMxB0C,EAAUpD,EAAOU,IAASsC,EAAahD,EAAOU,IACnD2C,EAAYrD,EAAOU,GACnBV,EAAM0C,KAAKhH,SAGXoF,EAASd,KAtIjB,SAAoBA,EAAOS,EAAMC,EAAM4C,GACnCjD,EAAaL,GACbA,EAAMC,WAAWC,QAAU,CAACO,EAAMC,GAClChB,EAAiBM,EAAMC,WAAWE,OAAOoD,IAAK9C,EAAMC,EAAM4C,GAyHtDE,CAAWxD,EAAOS,EAAMC,EAAM,CAC1BmC,QAAS7C,EAAM8C,MAAMD,UAEzB/B,EAASd,IAQb,OAAO,EA2CX,SAASqD,EAAYrD,EAAO8B,GACxB9B,EAAMa,SAAWiB,EACbkB,EAAahD,EAAO8B,GACpB9B,EAAMC,WAAWiC,MAAQzC,EAAUwD,QAAQjD,EAAMW,OAAQmB,EAAK9B,EAAMC,WAAWiD,QAG/ElD,EAAMC,WAAWiC,WAAQ5G,EAGjC,SAASwF,EAASd,GACdA,EAAMa,cAAWvF,EACjB0E,EAAMC,WAAWiC,WAAQ5G,EACzB0E,EAAM0C,KAAK7G,SAGf,SAASuH,EAAUpD,EAAOS,GACtB,IAAIoB,EAAQ7B,EAAMW,OAAOF,GACzB,OAAOoB,IAAkC,SAAxB7B,EAAMiC,QAAQnF,OAAqBkD,EAAMiC,QAAQnF,QAAU+E,EAAM/E,OAC9EkD,EAAMmC,YAAcN,EAAM/E,OAElC,SAAS0F,EAAQxC,EAAOS,EAAMC,GAC1B,OAAOD,IAASC,GAAQ0C,EAAUpD,EAAOS,KAAUT,EAAMiC,QAAQwB,QAAWzD,EAAMiC,QAAQC,OAAS1C,EAAOvD,UAAU+D,EAAMiC,QAAQC,MAAMzB,GAAOC,IAQnJ,SAASsC,EAAahD,EAAOS,GACzB,IAAIoB,EAAQ7B,EAAMW,OAAOF,GACzB,OAAOoB,GAAS7B,EAAMC,WAAWyD,SAC7B1D,EAAMiC,QAAQnF,QAAU+E,EAAM/E,OAC9BkD,EAAMmC,YAAcN,EAAM/E,MA6DlC,SAAS6G,EAAW3D,GAChBD,EAAaC,GACbK,EAAaL,GACbc,EAASd,GAzTbnG,EAAQ6F,iBAAmBA,EAO3B7F,EAAQ+J,kBANR,SAA2B5D,GACvBA,EAAM6D,YAAcrE,EAAOxD,SAASgE,EAAM6D,aAC1C7D,EAAMsC,UAAUpC,QACZF,EAAM8D,UAAU5D,QACZF,EAAMa,cAAWvF,GAS7BzB,EAAQkK,MANR,SAAe/D,GACXA,EAAMyB,cAAWnG,EACjBwF,EAASd,GACTD,EAAaC,GACbK,EAAaL,IAYjBnG,EAAQmK,UATR,SAAmBhE,EAAOW,GACtB,IAAK,IAAImB,KAAOnB,EAAQ,CACpB,IAAIkB,EAAQlB,EAAOmB,GACfD,EACA7B,EAAMW,OAAOmB,GAAOD,SAEb7B,EAAMW,OAAOmB,KAgBhCjI,EAAQoK,SAZR,SAAkBjE,EAAOlD,GAGrB,IAFc,IAAVA,IACAA,EAAQkD,EAAMmC,WACbrF,EAGD,IAAK,IAAI9B,KAAKgF,EAAMW,OACa,SAAzBX,EAAMW,OAAO3F,GAAG6B,MAAmBmD,EAAMW,OAAO3F,GAAG8B,QAAUA,IAC7DkD,EAAM0B,MAAQ1G,QAJtBgF,EAAM0B,WAAQpG,GAoBtBzB,EAAQkG,aAAeA,EAgBvBlG,EAAQwG,aAAeA,EAoDvBxG,EAAQ2G,SAAWA,EAiBnB3G,EAAQ+H,aAAeA,EAyCvB/H,EAAQ0I,SAAWA,EAoBnB1I,EAAQmI,aAnBR,SAAsBhC,EAAOS,EAAMC,EAAMqB,GACrC,GA+DJ,SAAiB/B,EAAOS,EAAMC,GAC1B,IAAImB,EAAQ7B,EAAMW,OAAOF,GACzB,OAAOoB,GAASnB,IAASD,IAASC,IAASV,EAAMW,OAAOD,MAAmC,SAAxBV,EAAMiC,QAAQnF,OAAqBkD,EAAMiC,QAAQnF,QAAU+E,EAAM/E,OAChIkD,EAAMmC,YAAcN,EAAM/E,OAlE1BoH,CAAQlE,EAAOS,EAAMC,IAASqB,EAAO,CACrC,IAAIF,EAAQ7B,EAAMW,OAAOF,UAClBT,EAAMW,OAAOF,GACpBmB,EAAa5B,EAAO6B,EAAOnB,EAAMqB,GACjCrC,EAAiBM,EAAMiC,QAAQ9B,OAAOgE,cAAetC,EAAMhF,KAAM6D,EAAM,CACnE0D,SAAS,SA0ErB,SAAoBpE,EAAOS,EAAMC,GAC7B,IAAImB,EAAQ7B,EAAMW,OAAOF,GACzB,OAAOoB,GAASnB,KACVV,EAAMW,OAAOD,IAASV,EAAMW,OAAOD,GAAM5D,QAAUkD,EAAMiC,QAAQnF,QACnEkD,EAAMO,aAAamD,UACH,SAAf7B,EAAMhF,MAAgC,MAAZ6D,EAAK,IAA0B,MAAZA,EAAK,KACnDV,EAAMiC,QAAQnF,QAAU+E,EAAM/E,OAC9BkD,EAAMmC,YAAcN,EAAM/E,MA9ErBuH,CAAWrE,EAAOS,EAAMC,IAI7BX,EAAaC,GACbK,EAAaL,IA5IrB,SAAoBA,EAAOnD,EAAMiF,GAC7B/B,EAAaC,GACbA,EAAMO,aAAaL,QAAU,CACzBrD,KAAMA,EACNiF,IAAKA,GAETpC,EAAiBM,EAAMO,aAAaJ,OAAOoD,IAAK1G,EAAMiF,GAkIlDwC,CAAWtE,EAAOA,EAAMW,OAAOF,GAAM5D,KAAM6D,UAMxCV,EAAMW,OAAOF,GACpBK,EAASd,IAsBbnG,EAAQ0K,aAnBR,SAAsBvE,EAAO8B,EAAKC,GAC1B/B,EAAMa,SACFb,EAAMa,WAAaiB,GAAQ9B,EAAM8D,UAAUJ,SAIrC1D,EAAMwE,WAAWd,SAAW3B,IAAU/B,EAAMa,WAAaiB,EAC3DS,EAASvC,EAAOA,EAAMa,SAAUiB,KAChC9B,EAAM8C,MAAM2B,SAAU,GAG1BzE,EAAM0C,KAAKhH,SARXoF,EAASd,GACTA,EAAM0C,KAAK7G,WASVuH,EAAUpD,EAAO8B,IAAQkB,EAAahD,EAAO8B,MAClDuB,EAAYrD,EAAO8B,GACnB9B,EAAM0C,KAAKhH,SAEfgE,EAAiBM,EAAMG,OAAOuE,OAAQ5C,IAW1CjI,EAAQwJ,YAAcA,EAMtBxJ,EAAQiH,SAAWA,EASnBjH,EAAQ2I,QAAUA,EA8BlB3I,EAAQ8K,YAJR,SAAqB3E,EAAOS,GACxB,IAAIoB,EAAQ7B,EAAMW,OAAOF,GACzB,OAAOoB,GAAS7B,EAAM8D,UAAUJ,UAAoC,SAAxB1D,EAAMiC,QAAQnF,OAAqBkD,EAAMiC,QAAQnF,QAAU+E,EAAM/E,QAAUkD,EAAMmC,YAAcN,EAAM/E,OAASkD,EAAMC,WAAWyD,WAsB/K7J,EAAQ+K,YAnBR,SAAqB5E,GACjB,IAAIe,EAAOf,EAAMC,WAAWC,QAC5B,IAAKa,EACD,OAAO,EACX,IAAIN,EAAOM,EAAK,GAAIL,EAAOK,EAAK,GAC5B8D,GAAU,EACd,GAAIrC,EAAQxC,EAAOS,EAAMC,GAAO,CAC5B,IAAI2B,EAASD,EAAapC,EAAOS,EAAMC,GACvC,GAAI2B,EAAQ,CACR,IAAIM,EAAW,CAAEC,SAAS,IACX,IAAXP,IACAM,EAAS/B,SAAWyB,GACxB3C,EAAiBM,EAAMiC,QAAQ9B,OAAO4C,MAAOtC,EAAMC,EAAMiC,GACzDkC,GAAU,GAIlB,OADA9E,EAAaC,GACN6E,GAsBXhL,EAAQiL,YAnBR,SAAqB9E,EAAO+E,GACxB,IAAIC,EAAOhF,EAAMO,aAAaL,QAAS2E,GAAU,EACjD,QAAKG,IAEDD,EAASC,IAKLpD,EAAa5B,EAJL,CACRnD,KAAMmI,EAAKnI,KACXC,MAAOkD,EAAMiC,QAAQnF,OAEMkI,EAAKlD,OAChCpC,EAAiBM,EAAMiC,QAAQ9B,OAAOgE,cAAea,EAAKnI,KAAMmI,EAAKlD,IAAK,CACtEsC,SAAS,IAEbS,GAAU,GAGlBxE,EAAaL,GACN6E,IAQXhL,EAAQ8J,WAAaA,EAOrB9J,EAAQiC,KANR,SAAckE,GACVA,EAAMiC,QAAQnF,MACVkD,EAAMiC,QAAQC,MACVlC,EAAMsC,UAAUpC,aAAU5E,EAClCqI,EAAW3D,IAYfnG,EAAQoL,eATR,SAAwBnK,EAAKsC,EAASI,GAClC,IAAI0H,EAAO1I,KAAK2I,MAAWrK,EAAI,GAAK0C,EAAOU,MAAQV,EAAOC,MAArC,GAChBL,IACD8H,EAAO,EAAIA,GACf,IAAIE,EAAO5I,KAAK2I,KAAK,GAAWrK,EAAI,GAAK0C,EAAOW,KAAOX,EAAOE,OAApC,GAG1B,OAFKN,IACDgI,EAAO,EAAIA,GACPF,EAAO,GAAKA,EAAO,GAAKE,EAAO,GAAKA,EAAO,EAAK5F,EAAO3E,QAAQ,CAACqK,EAAME,SAAS9J,I,iCCrV3F3B,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtDD,EAAQW,MAAQ,CAAC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,KACpDX,EAAQc,MAAQ,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,I,iCCFtChB,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtD,IAAI0F,EAAS,EAAQ,KACjBzF,EAAK,EAAQ,KACjBF,EAAQwL,QAAU,8CAClB,IAAIC,EAAQ,CAAEC,EAAG,OAAQ3K,EAAG,OAAQ4K,EAAG,SAAUC,EAAG,SAAUC,EAAG,QAAS1K,EAAG,QACzE2K,EAAU,CAAEC,KAAM,IAAKrE,KAAM,IAAKsE,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAK9E,KAAM,KAoClFpH,EAAQmM,KAnCR,SAAcC,GACE,UAARA,IACAA,EAAMpM,EAAQwL,SAIlB,IAHA,IAAI1E,EAAS,GACTuF,EAAM,EACNC,EAAM,EACDvG,EAAK,EAAGwG,EAAQH,EAAKrG,EAAKwG,EAAMtG,OAAQF,IAAM,CACnD,IAAIlF,EAAI0L,EAAMxG,GACd,OAAQlF,GACJ,IAAK,IAAK,OAAOiG,EACjB,IAAK,IAED,GAAY,MADVuF,EAEE,OAAOvF,EACXwF,EAAM,EACN,MACJ,IAAK,IACDxF,EAAOnB,EAAO3E,QAAQ,CAACsL,EAAKD,KAAOG,UAAW,EAC9C,MACJ,QACI,IAAIC,EAAK5L,EAAEO,WAAW,GACtB,GAAIqL,EAAK,GACLH,GAAOG,EAAK,OACX,GACCH,EACF,IAAItJ,EAAOnC,EAAE6L,cACb5F,EAAOnB,EAAO3E,QAAQ,CAACsL,EAAKD,KAAS,CACjCrJ,KAAMyI,EAAMzI,GACZC,MAAQpC,IAAMmC,EAAO,QAAU,WAKnD,OAAO8D,GAeX9G,EAAQ2M,MAZR,SAAe7F,GACX,IAAIkB,EAAO4E,EACX,OAAOjH,EAAOvF,SAASQ,KAAI,SAAUiM,GAAK,OAAO3M,EAAGY,MAAMF,KAAI,SAAU0B,GAEpE,OADA0F,EAAQlB,EAAOnB,EAAO3E,QAAQ,CAACsB,EAAGuK,OAE9BD,EAASd,EAAQ9D,EAAMhF,MACA,UAAhBgF,EAAM/E,MAAoB2J,EAAOE,cAAgBF,GAGjD,OACZG,KAAK,OAAQA,KAAK,KAAKC,QAAQ,UAAU,SAAUC,GAAK,OAAOA,EAAEhH,OAAOiH,gB,iCCpD/EpN,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtD,IAAIkN,EAAU,EAAQ,KAClBZ,EAAQ,EAAQ,KAyCpB,SAASa,EAASC,GACd,MAAoB,iBAANA,EAXlBrN,EAAQsN,UA9BR,SAAmBnH,EAAOoH,GAkBtB,GAjBIA,EAAOnF,SAAWmF,EAAOnF,QAAQC,QACjClC,EAAMiC,QAAQC,WAAQ5G,GA8B9B,SAAS+L,EAAMC,EAAMC,GACjB,IAAK,IAAIzF,KAAOyF,EACRN,EAASK,EAAKxF,KAASmF,EAASM,EAAOzF,IACvCuF,EAAMC,EAAKxF,GAAMyF,EAAOzF,IAExBwF,EAAKxF,GAAOyF,EAAOzF,GAlC3BuF,CAAMrH,EAAOoH,GACTA,EAAOnB,MACPjG,EAAMW,OAASyF,EAAMJ,KAAKoB,EAAOnB,KACjCjG,EAAMwH,SAASC,OAAS,IAExBL,EAAOM,eAAe,UACtBV,EAAQ/C,SAASjE,EAAOoH,EAAO1F,QAAS,GACxC0F,EAAOM,eAAe,cAAgBN,EAAO3F,SAC7CzB,EAAMyB,cAAWnG,EACZ8L,EAAO3F,WACZzB,EAAMyB,SAAW2F,EAAO3F,UACxBzB,EAAMa,UACNmG,EAAQ3D,YAAYrD,EAAOA,EAAMa,YAChCb,EAAMsC,UAAUqF,UAAY3H,EAAMsC,UAAUqF,SAAW,OACxD3H,EAAMsC,UAAUoB,SAAU,IACzB1D,EAAMiC,QAAQ2F,YAAc5H,EAAMiC,QAAQC,MAAO,CAClD,IAAI2F,EAAiC,UAAxB7H,EAAMiC,QAAQnF,MAAoB,EAAI,EAC/CgL,EAAe,IAAMD,EACrBE,EAAU/H,EAAMiC,QAAQC,MAAM4F,GAClC,IAAKC,GAA+C,SAApC/H,EAAMW,OAAOmH,GAAcjL,KACvC,OACJmD,EAAMiC,QAAQC,MAAM4F,GAAgBC,EAAQC,QAAO,SAAUC,GACzD,QAAUA,IAAM,IAAMJ,IAA8C,IAAnCE,EAAQ3L,QAAQ,IAAMyL,IAChDI,IAAM,IAAMJ,IAA8C,IAAnCE,EAAQ3L,QAAQ,IAAMyL,U,iCC7BhE,IAAIK,EAAYC,MAAQA,KAAKD,UAAavO,OAAOyO,QAAU,SAASC,GAChE,IAAK,IAAIvB,EAAGwB,EAAI,EAAG9C,EAAI3F,UAAUC,OAAQwI,EAAI9C,EAAG8C,IAE5C,IAAK,IAAI/C,KADTuB,EAAIjH,UAAUyI,GACO3O,OAAOU,UAAUqN,eAAea,KAAKzB,EAAGvB,KACzD8C,EAAE9C,GAAKuB,EAAEvB,IAEjB,OAAO8C,GAEX1O,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtD,IAAI0O,EAAO,EAAQ,KAKnB,SAASC,EAAOC,EAAU1I,GACtB,IAAIqC,EAASqG,EAAS1I,GAEtB,OADAA,EAAM2I,IAAIC,SACHvG,EAGX,SAASwG,EAAU/G,EAAKD,GACpB,MAAO,CACHC,IAAKA,EACLhH,IAAK0N,EAAKzN,QAAQ+G,GAClBD,MAAOA,GAXfhI,EAAQiP,KAHR,SAAcJ,EAAU1I,GACpB,OAAOA,EAAMsC,UAAUoB,QAyF3B,SAAiBgF,EAAU1I,GACvB,IAAI+I,EAAab,EAAS,GAAIlI,EAAMW,QAChC0B,EAASqG,EAAS1I,GAClBgJ,EAvER,SAAqBD,EAAY7I,GAC7B,IACI+I,EAAMC,EAAMZ,EAAGa,EADfC,EAAQ,GAAIC,EAAc,GAAIC,EAAU,GAAIC,EAAW,GAAIC,EAAO,GAAIC,EAAY,GAEtF,IAAKnB,KAAKS,EACNU,EAAUnB,GAAKO,EAAUP,EAAGS,EAAWT,IAE3C,IAAK,IAAI1I,EAAK,EAAGzF,EAAKqO,EAAKtO,QAAS0F,EAAKzF,EAAG2F,OAAQF,IAAM,CACtD,IAAIkC,EAAM3H,EAAGyF,GACbqJ,EAAO/I,EAAQS,OAAOmB,GACtBoH,EAAOO,EAAU3H,GACbmH,EACIC,EACKV,EAAK9L,UAAUuM,EAAMC,EAAKrH,SAC3B0H,EAASG,KAAKR,GACdM,EAAKE,KAAKb,EAAU/G,EAAKmH,KAI7BO,EAAKE,KAAKb,EAAU/G,EAAKmH,IAExBC,GACLK,EAASG,KAAKR,GAetB,OAbAM,EAAKG,SAAQ,SAAUC,GA5B3B,IAAgB/H,EAAOlB,EAAPkB,EA6BM+H,EA7BCjJ,EA6BK4I,EAASvB,QAAO,SAAUzC,GAAK,OAAOiD,EAAK9L,UAAUkN,EAAK/H,MAAO0D,EAAE1D,WAAvFqH,EA5BGvI,EAAOkJ,MAAK,SAAUlN,EAAIC,GAC7B,OAAO4L,EAAKnM,WAAWwF,EAAM/G,IAAK6B,EAAG7B,KAAO0N,EAAKnM,WAAWwF,EAAM/G,IAAK8B,EAAG9B,QAC3E,MA4BKqO,EAAS,CAACD,EAAKpO,IAAI,GAAK8O,EAAK9O,IAAI,GAAIoO,EAAKpO,IAAI,GAAK8O,EAAK9O,IAAI,IAC5DsO,EAAMQ,EAAK9H,KAAOqH,EAAO7O,OAAO6O,GAChCE,EAAYK,KAAKR,EAAKpH,SAG9ByH,EAASI,SAAQ,SAAUpE,GAClBiD,EAAKvM,UAAUoN,EAAa9D,EAAEzD,MAC7B5B,EAAQ4J,OAAQ5J,EAAQ4J,MAAMvE,EAAEzK,IAAKyK,EAAEzD,OACzCwH,EAAQ/D,EAAEzD,KAAOyD,EAAE1D,UAEpB,CACHuH,MAAOA,EACPE,QAASA,GAiCFS,CAAYhB,EAAY/I,GACnC,GAAKgK,EAAchB,EAAKI,QAAWY,EAAchB,EAAKM,SAWlDtJ,EAAM2I,IAAIC,aAXkD,CAC5D,IAAIqB,EAAiBjK,EAAMsC,UAAUpC,SAAWF,EAAMsC,UAAUpC,QAAQxE,MACxEsE,EAAMsC,UAAUpC,QAAU,CACtBxE,MAAOwO,EAAKtO,MACZuO,UAAW,EAAInK,EAAMsC,UAAUqF,SAC/BqB,KAAMA,GAELiB,GArCb,SAASG,EAAKpK,EAAOpE,GACjB,IAAIyO,EAAMrK,EAAMsC,UAAUpC,QAC1B,QAAY5E,IAAR+O,EAGA,YAFKrK,EAAM2I,IAAI2B,WACXtK,EAAM2I,IAAI4B,aAGlB,IAAIC,EAAO,GAAK5O,EAAMyO,EAAI3O,OAAS2O,EAAIF,UACvC,GAAIK,GAAQ,EACRxK,EAAMsC,UAAUpC,aAAU5E,EAC1B0E,EAAM2I,IAAI4B,gBAET,CACD,IAAIE,GAqCIpC,EArCUmC,GAsCX,GAAM,EAAInC,EAAIA,EAAIA,GAAKA,EAAI,IAAM,EAAIA,EAAI,IAAM,EAAIA,EAAI,GAAK,EArCnE,IAAK,IAAIC,KAAK+B,EAAIrB,KAAKI,MAAO,CAC1B,IAAIsB,EAAML,EAAIrB,KAAKI,MAAMd,GACzBoC,EAAI,GAAKA,EAAI,GAAKD,EAClBC,EAAI,GAAKA,EAAI,GAAKD,EAEtBzK,EAAM2I,IAAI4B,WAAU,GACpB/B,EAAKpJ,KAAI,SAAUxD,GAEf,YADY,IAARA,IAAkBA,EAAMsO,EAAKtO,OAC1BwO,EAAKpK,EAAOpE,MA4B/B,IAAgByM,EAZJ+B,CAAKpK,EAAOkK,EAAKtO,OAKzB,OAAOyG,EA1G0BsI,CAAQjC,EAAU1I,GAASyI,EAAOC,EAAU1I,IAQjFnG,EAAQ4O,OAASA,EAsDjB,IAAIyB,OAA8B5O,IAAvB0B,OAAO4N,YAA4B5N,OAAO4N,YAAcjP,KA8CnE,SAASqO,EAAc9C,GACnB,IAAK,IAAI2D,KAAK3D,EACV,OAAO,EACX,OAAO,I,iCC1HXvN,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtD,IAAIgR,EAAQ,EAAQ,KAChBtC,EAAO,EAAQ,KACfuC,EAAS,EAAQ,KACjBC,EAAS,EAAQ,KAwFrB,SAASC,EAAYnE,GACjB0B,EAAKpJ,KAAI,WACL,IAAIiL,EAAMvD,EAAEhD,UAAU5D,QACtB,GAAKmK,EAAL,CAEIvD,EAAExE,UAAUpC,SAAW4G,EAAExE,UAAUpC,QAAQ8I,KAAKI,MAAMiB,EAAI5J,QAC1DqG,EAAExE,UAAUpC,aAAU5E,GAC1B,IAAI4P,EAAYpE,EAAEnG,OAAO0J,EAAI5J,MAC7B,GAAKyK,GAAc1C,EAAK9L,UAAUwO,EAAWb,EAAIxI,QAK7C,IAFKwI,EAAIc,SAAW3C,EAAKnM,WAAWgO,EAAIe,KAAMf,EAAIgB,MAAQ7O,KAAKC,IAAIqK,EAAEhD,UAAUwH,SAAU,KACrFjB,EAAIc,SAAU,GACdd,EAAIc,QAAS,CACb,GAA2B,mBAAhBd,EAAIkB,QAAwB,CACnC,IAAIC,EAAQnB,EAAIkB,UAChB,IAAKC,EACD,OACJnB,EAAIkB,QAAUC,EACdnB,EAAIkB,QAAQE,YAAa,EACzBpB,EAAIkB,QAAQG,UAAUC,IAAI,YAE9B,IAAIvO,EAA4B,UAAlB0J,EAAEjD,YAAyBrG,EAASsJ,EAAE6B,IAAInL,SACxD6M,EAAIvP,IAAM,CACNuP,EAAIe,KAAK,GAAKf,EAAIgB,IAAI,GACtBhB,EAAIe,KAAK,GAAKf,EAAIgB,IAAI,IAE1B,IAAIO,EAAcpD,EAAKjL,kBAAkBC,EAAvBgL,CAA+B6B,EAAInJ,QAAS9D,GAC9DwO,EAAY,IAAMvB,EAAIvP,IAAI,GAAKuP,EAAIwB,IAAI,GACvCD,EAAY,IAAMvB,EAAIvP,IAAI,GAAKuP,EAAIwB,IAAI,GACvCrD,EAAK5K,aAAayM,EAAIkB,QAASK,SArBnC/P,EAAOiL,GAwBXmE,EAAYnE,OA8CpB,SAASjL,EAAOiL,GACZ,IAAIuD,EAAMvD,EAAEhD,UAAU5D,QAClBmK,IACIA,EAAIyB,iBACGhF,EAAEnG,OAAO0J,EAAI5J,MACxBqG,EAAEhD,UAAU5D,aAAU5E,EACtBwP,EAAMhK,SAASgG,GACfiF,EAAmBjF,GACnBA,EAAE6B,IAAIC,UAId,SAASmD,EAAmBjF,GACxB,IAAIvI,EAAIuI,EAAE6B,IAAIqD,SACVzN,EAAE0N,OACFzD,EAAKpK,WAAWG,EAAE0N,OAAO,GAEjC,SAASC,EAAoBpK,EAAK1E,EAASI,GACvC,IAAI1C,EAAM0N,EAAKzN,QAAQ+G,GAKvB,OAJK1E,IACDtC,EAAI,GAAK,EAAIA,EAAI,GACjBA,EAAI,GAAK,EAAIA,EAAI,IAEd,CACHoD,KAAMV,EAAOU,KAAOV,EAAOC,OAAS3C,EAAI,GAAK,GAAK,EAClDqD,IAAKX,EAAOW,IAAMX,EAAOE,QAAU,EAAI5C,EAAI,IAAM,EACjD2C,MAAOD,EAAOC,MAAQ,EACtBC,OAAQF,EAAOE,OAAS,GAGhC,SAASyO,EAAkBrF,EAAGhF,GAE1B,IADA,IAAIjE,EAAKiJ,EAAE6B,IAAIqD,SAASlB,MAAMsB,WACvBvO,GAAI,CACP,GAAIA,EAAGwO,QAAUvK,GAAsB,UAAfjE,EAAGmB,QACvB,OAAOnB,EACXA,EAAKA,EAAGyO,aA7IhBzS,EAAQ6B,MA5DR,SAAeoL,EAAGvI,GACd,UAAiBjD,IAAbiD,EAAEO,QAAqC,IAAbP,EAAEO,QAE5BP,EAAEG,SAAWH,EAAEG,QAAQoB,OAAS,GAApC,CAEAvB,EAAEgO,iBACF,IAAInP,EAA4B,UAAlB0J,EAAEjD,YAAyBrG,EAASsJ,EAAE6B,IAAInL,SAAUgP,EAAWhE,EAAKlK,cAAcC,GAAIkC,EAAOqK,EAAM7F,eAAeuH,EAAUpP,EAASI,GACnJ,GAAKiD,EAAL,CAEA,IAAIoB,EAAQiF,EAAEnG,OAAOF,GACjBgM,EAAqB3F,EAAEjG,SACtB4L,IAAsB3F,EAAEU,SAAS9D,UAAYoD,EAAEU,SAASkF,cAAkB7K,GAASA,EAAM/E,QAAUgK,EAAE3E,WACtG4I,EAAOxP,MAAMuL,GACjB,IAAI6F,IAAe7F,EAAE7G,WAAWC,QAC5B0M,IAAe9F,EAAEvG,aAAaL,QAClC4G,EAAEhE,MAAMD,QAAUtE,EAAEsE,QAChBiE,EAAEjG,UAAYiK,EAAMtI,QAAQsE,EAAGA,EAAEjG,SAAUJ,GAC3CuK,EAAOlC,MAAK,SAAU9I,GAAS,OAAO8K,EAAMvG,aAAavE,EAAOS,KAAUqG,GAG1EgE,EAAMvG,aAAauC,EAAGrG,GAE1B,IAAIoM,EAAgB/F,EAAEjG,WAAaJ,EAC/B8K,EAAUY,EAAkBrF,EAAGrG,GACnC,GAAIoB,GAAS0J,GAAWsB,GAAiB/B,EAAMnG,YAAYmC,EAAGrG,GAAO,CACjE,IAAIqM,EAAeZ,EAAoBzL,EAAMrD,EAASI,GACtDsJ,EAAEhD,UAAU5D,QAAU,CAClBO,KAAMA,EACNS,QAASsH,EAAKzN,QAAQ0F,GACtBoB,MAAOA,EACPwJ,IAAKmB,EACLpB,KAAMoB,EACN1R,IAAK,CAAC,EAAG,GACT+Q,IAAK/E,EAAEhD,UAAUiJ,YAAc,CAC3BP,EAAS,IAAMM,EAAa5O,KAAO4O,EAAarP,MAAQ,GACxD+O,EAAS,IAAMM,EAAa3O,IAAM2O,EAAapP,OAAS,IACxD,CAAC,EAAG,GACRyN,QAASrE,EAAEhD,UAAUkJ,cAAgBlG,EAAEhE,MAAM2B,QAC7C8G,QAASA,EACTkB,mBAAoBA,EACpBQ,aAAc1O,EAAE2O,QAEpB3B,EAAQE,YAAa,EACrBF,EAAQG,UAAUC,IAAI,YACtB,IAAIM,EAAQnF,EAAE6B,IAAIqD,SAASC,MACvBA,IACAA,EAAMhN,UAAY,SAAW4C,EAAM/E,MAAQ,IAAM+E,EAAMhF,KACvD2L,EAAK5K,aAAaqO,EAAOzD,EAAKjL,kBAAkBC,EAAvBgL,CAA+BA,EAAKzN,QAAQ0F,GAAOrD,IAC5EoL,EAAKpK,WAAW6N,GAAO,IAE3BhB,EAAYnE,QAGR6F,GACA7B,EAAM/K,aAAa+G,GACnB8F,GACA9B,EAAMzK,aAAayG,GAE3BA,EAAE6B,IAAIC,YA4BV/O,EAAQsT,aAzBR,SAAsBrG,EAAGjF,EAAOtD,EAAGwD,GAE/B+E,EAAEnG,OAAU,GAAIkB,EAChBiF,EAAE6B,IAAIC,SACN,IAAI4D,EAAWhE,EAAKlK,cAAcC,GAAInB,EAA4B,UAAlB0J,EAAEjD,YAAyBrG,EAASsJ,EAAE6B,IAAInL,SAAUsP,EAAeZ,EAHzG,KAGkI9O,EAASI,GACjJ6N,EAAM,EACLjO,EAAU,EAAI,GAAK0P,EAAarP,MAAQD,EAAOU,MAC/Cd,EAAU,GAAK,GAAK0P,EAAapP,OAASF,EAAOW,KAEtD2I,EAAEhD,UAAU5D,QAAU,CAClBO,KATM,KAUNS,QAASsH,EAAKzN,QAVR,MAWN8G,MAAOA,EACPwJ,IAAKA,EACLD,KAAMoB,EACN1R,IAAK,CAAC0R,EAAS,GAAKnB,EAAI,GAAImB,EAAS,GAAKnB,EAAI,IAC9CQ,IAAK,EAAEiB,EAAarP,MAAQ,GAAIqP,EAAapP,OAAS,GACtDyN,SAAS,EACTI,QAAS,WAAc,OAAOY,EAAkBrF,EAjB1C,OAkBNmG,aAAc1O,EAAE2O,OAChBpB,UAAU,EACV/J,MAAOA,IAAS,GAEpBkJ,EAAYnE,IA4ChBjN,EAAQkH,KALR,SAAc+F,EAAGvI,GACTuI,EAAEhD,UAAU5D,WAAa3B,EAAEG,SAAWH,EAAEG,QAAQoB,OAAS,KACzDgH,EAAEhD,UAAU5D,QAAQkL,KAAO5C,EAAKlK,cAAcC,KAwCtD1E,EAAQuT,IApCR,SAAatG,EAAGvI,GACZ,IAAI8L,EAAMvD,EAAEhD,UAAU5D,QACtB,GAAKmK,EAEL,GAAe,aAAX9L,EAAE8O,OAAuBhD,GAAOA,EAAI4C,eAAiB1O,EAAE2O,QAAW7C,EAAIyB,SAA1E,CAIAhB,EAAM/K,aAAa+G,GACnBgE,EAAMzK,aAAayG,GACnB,IAAIwG,EAAW9E,EAAKlK,cAAcC,IAAM8L,EAAIe,KACxC1K,EAAOoK,EAAM7F,eAAeqI,EAA4B,UAAlBxG,EAAEjD,YAAyBiD,EAAE6B,IAAInL,UACvEkD,GAAQ2J,EAAIc,QACRd,EAAIyB,SACJhB,EAAM9I,aAAa8E,EAAGuD,EAAI5J,KAAMC,EAAM2J,EAAItI,QAE1C+E,EAAEhE,MAAMD,QAAUtE,EAAEsE,QAChBiI,EAAMvI,SAASuE,EAAGuD,EAAI5J,KAAMC,KAC5BoG,EAAEhE,MAAM2B,SAAU,IAGrB4F,EAAIyB,gBACFhF,EAAEnG,OAAO0J,EAAI5J,MAEfqG,EAAEhD,UAAUyJ,yBACVzG,EAAEnG,OAAO0J,EAAI5J,MACpBqK,EAAMpL,iBAAiBoH,EAAE3G,OAAOwB,WAEhC0I,GAAOA,EAAI5J,OAAS4J,EAAIoC,oBAAuBpC,EAAI5J,OAASC,GAASA,IAE/DoG,EAAEtC,WAAWd,SADnBoH,EAAMhK,SAASgG,GAGnBiF,EAAmBjF,GACnBA,EAAEhD,UAAU5D,aAAU5E,EACtBwL,EAAE6B,IAAIC,cA7BF9B,EAAEhD,UAAU5D,aAAU5E,GA2C9BzB,EAAQgC,OAASA,G,iCCtLjBlC,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtD,IAAIkN,EAAU,EAAQ,KAClBxH,EAAS,EAAQ,KACjBgO,EAAU,CAAC,QAAS,MAAO,OAAQ,UAmBvC,SAASC,EAAYzN,GACjBR,EAAOJ,KAAI,WACP,IAAIiL,EAAMrK,EAAMwH,SAAStH,QACzB,GAAImK,EAAK,CACL,IAAIqD,EAAU1G,EAAQ/B,eAAeoF,EAAIvP,IAA2B,UAAtBkF,EAAM6D,YAAyB7D,EAAM2I,IAAInL,UACnFkQ,IAAYrD,EAAIqD,UAChBrD,EAAIqD,QAAUA,EACdrD,EAAI3J,KAAOgN,IAAYrD,EAAI5J,KAAOiN,OAAUpS,EAC5C0E,EAAM2I,IAAI4B,aAEdkD,EAAYzN,OAmBxB,SAASnE,EAAOmE,GACRA,EAAMwH,SAAStH,UACfF,EAAMwH,SAAStH,aAAU5E,EACzB0E,EAAM2I,IAAIC,UAYlB,SAAS+E,EAAWpP,GAChB,IAAIqP,EAAIrP,EAAEsP,UAAYrO,EAAOZ,cAAcL,GAAK,EAAI,EAChDkH,EAAIlH,EAAEuP,OAAS,EAAI,EACvB,OAAON,EAAQI,EAAInI,GAgBvB,SAASsI,EAASvG,GACVA,EAASuG,UACTvG,EAASuG,SAASvG,EAASC,QAlEnC5N,EAAQ6B,MAjBR,SAAesE,EAAOzB,GAClB,KAAIA,EAAEG,SAAWH,EAAEG,QAAQoB,OAAS,GAApC,CAEAvB,EAAEyP,kBACFzP,EAAEgO,iBACFvF,EAAQrD,WAAW3D,GACnB,IAAIwM,EAAWhN,EAAOlB,cAAcC,GAChCkC,EAAOuG,EAAQ/B,eAAeuH,EAAgC,UAAtBxM,EAAM6D,YAAyB7D,EAAM2I,IAAInL,UAChFiD,IAELT,EAAMwH,SAAStH,QAAU,CACrBO,KAAMA,EACN3F,IAAK0R,EACLyB,MAAON,EAAWpP,IAEtBkP,EAAYzN,MAiBhBnG,EAAQ4T,YAAcA,EAKtB5T,EAAQkH,KAJR,SAAcf,EAAOzB,GACbyB,EAAMwH,SAAStH,UACfF,EAAMwH,SAAStH,QAAQpF,IAAM0E,EAAOlB,cAAcC,KAW1D1E,EAAQuT,IARR,SAAapN,GACT,IAAIqK,EAAMrK,EAAMwH,SAAStH,QACrBmK,IACIA,EAAIqD,SA6BhB,SAAkBlG,EAAU6C,GACxB,IAAI6D,EAAY,SAAUpH,GACtB,OAAOA,EAAErG,OAAS4J,EAAI5J,MAAQqG,EAAEpG,OAAS2J,EAAI3J,MAE7CyN,EAAU3G,EAASC,OAAOO,OAAOkG,GAAW,GAC5CC,IACA3G,EAASC,OAASD,EAASC,OAAOO,QAT7B7M,EASwC+S,EAR1C,SAAU/R,GAAK,OAAQhB,EAAEgB,OADpC,IAAahB,EAUJgT,GAAWA,EAAQF,QAAU5D,EAAI4D,OAClCzG,EAASC,OAAOiC,KAAKW,GACzB0D,EAASvG,GArCD4G,CAASpO,EAAMwH,SAAU6C,GAC7BxO,EAAOmE,KAUfnG,EAAQgC,OAASA,EAQjBhC,EAAQ0B,MAPR,SAAeyE,GACPA,EAAMwH,SAASC,OAAO3H,SACtBE,EAAMwH,SAASC,OAAS,GACxBzH,EAAM2I,IAAIC,SACVmF,EAAS/N,EAAMwH,a,iCC9DvB7N,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtD,IAKIuU,EALA7O,EAAS,EAAQ,KACrB,SAASL,EAAcH,GACnB,OAAOE,SAASoP,gBAAgB,6BAA8BtP,GA0ElE,SAASuP,EAAUpU,EAAIqU,EAAYtO,GAC/B,IASmBuO,EATfhO,EAAOtG,EAAGsG,KAAMC,EAAOvG,EAAGuG,KAAMuN,EAAQ9T,EAAG8T,MAAOpM,EAAQ1H,EAAG0H,MAAO6M,EAAYvU,EAAGuU,UACvF,MAAO,CAACxO,EAASO,EAAMC,EAAMuN,EAAOvN,GAAQ8N,EAAW9N,GAAQ,EAC3DmB,GAAS8M,EAAU9M,GACnB6M,IAMeD,EANYC,EAOxB,IAAMD,EAAEG,WAAa,MAN1B5G,QAAO,SAAU7L,GAAK,OAAOA,KAAMyK,KAAK,IAE9C,SAAS+H,EAAU9M,GACf,MAAO,CAACA,EAAM/E,MAAO+E,EAAMhF,KAAMgF,EAAMgN,OAAO7G,QAAO,SAAU7L,GAAK,OAAOA,KAAMyK,KAAK,IA6D1F,SAASkI,EAAab,GAClB,IAAIc,EAASC,EAAc7P,EAAc,UAAW,CAChD8P,GAAI,aAAehB,EAAMnM,IACzBoN,OAAQ,OACRC,YAAa,EACbC,aAAc,EACdC,KAAM,KACNC,KAAM,OAOV,OALAP,EAAOQ,YAAYP,EAAc7P,EAAc,QAAS,CACpD8I,EAAG,iBACHuH,KAAMvB,EAAMnR,SAEhBiS,EAAOU,aAAa,QAASxB,EAAMnM,KAC5BiN,EAEX,SAASC,EAAcnR,EAAI6R,GACvB,IAAK,IAAI5N,KAAO4N,EACZ7R,EAAG4R,aAAa3N,EAAK4N,EAAM5N,IAC/B,OAAOjE,EAEX,SAASqR,EAAOpU,EAAKgC,GACjB,MAAiB,UAAVA,EAAoBhC,EAAM,CAAC,EAAIA,EAAI,GAAI,EAAIA,EAAI,IAE1D,SAAS6U,EAAgBrI,EAAMoH,GAC3B,IAAIT,EAAQ,CACRnR,MAAOwK,EAAKxK,MACZ8S,QAASpT,KAAKqT,MAAqB,GAAfvI,EAAKsI,SAAgB,GACzChB,UAAWpS,KAAKqT,MAAMnB,EAAUE,WAAatH,EAAKsH,YAGtD,OADAX,EAAMnM,IAAM,CAACwF,EAAKxF,IAAK4M,EAAUE,WAAW5G,QAAO,SAAU7L,GAAK,OAAOA,KAAMyK,KAAK,IAC7EqH,EAMX,SAASW,EAAUX,EAAO/N,EAAS1C,GAC/B,OAAQyQ,EAAMW,WAAa,KAAO1O,EAAU,IAAO,GAAK,IAAM1C,EAAOC,MAEzE,SAASmS,EAAQ3B,EAAO/N,GACpB,OAAQ+N,EAAM2B,SAAW,IAAM1P,EAAU,GAAM,GAKnD,SAAS4P,EAAOhV,EAAK0C,GACjB,MAAO,EAAE1C,EAAI,GAAK,IAAO0C,EAAOC,MAAQ,GAAI,IAAM3C,EAAI,IAAM0C,EAAOE,OAAS,GA5LhF7D,EAAQsF,cAAgBA,EA6BxBtF,EAAQkW,UA3BR,SAAmB/P,EAAOgQ,GACtB,IAAI/H,EAAIjI,EAAMwH,SAAUyI,EAAOhI,EAAE/H,QAASmK,EAAM4F,GAAQA,EAAKvC,QAAUuC,OAAO3U,EAAWkT,EAAa,GACtGvG,EAAER,OAAOnN,OAAO2N,EAAEiI,YAAY5V,OAAO+P,EAAM,CAACA,GAAO,IAAIV,SAAQ,SAAU7C,GACjEA,EAAEpG,OACF8N,EAAW1H,EAAEpG,OAAS8N,EAAW1H,EAAEpG,OAAS,GAAK,MAEzD,IAAI+G,EAASQ,EAAER,OAAOnN,OAAO2N,EAAEiI,YAAYzV,KAAI,SAAUqM,GACrD,MAAO,CACHqJ,MAAOrJ,EACP5G,SAAS,EACTkQ,KAAM7B,EAAUzH,EAAG0H,GAAY,OAGnCnE,GACA5C,EAAOiC,KAAK,CACRyG,MAAO9F,EACPnK,SAAS,EACTkQ,KAAM7B,EAAUlE,EAAKmE,GAAY,KAEzC,IAAI6B,EAAW5I,EAAOhN,KAAI,SAAU6V,GAAM,OAAOA,EAAGF,QAASxJ,KAAK,IAClE,GAAIyJ,IAAarQ,EAAMwH,SAAS+I,YAAhC,CAEAvQ,EAAMwH,SAAS+I,YAAcF,EAC7B,IAAIG,EAASR,EAAK5D,YAKtB,SAAkBnE,EAAGR,EAAQ+I,GACzB,IACIvC,EADAT,EAAU,GAEd/F,EAAOkC,SAAQ,SAAU7C,GACjBA,EAAEqJ,MAAMzP,OACRuN,EAAQhG,EAAEuF,QAAQ1G,EAAEqJ,MAAMlC,OACtBnH,EAAEqJ,MAAMzB,YACRT,EAAQ0B,EAAgB1B,EAAOnH,EAAEqJ,MAAMzB,YAC3ClB,EAAQS,EAAMnM,KAAOmM,MAG7B,IAAIwC,EAAY,GACZ5S,EAAK2S,EAAOpE,WAChB,KAAOvO,GACH4S,EAAU5S,EAAG6S,aAAa,WAAY,EACtC7S,EAAKA,EAAGyO,YAEZ,IAAK,IAAIxK,KAAO0L,EACPiD,EAAU3O,IACX0O,EAAOjB,YAAYT,EAAatB,EAAQ1L,KAvBhD6O,CAAS1I,EAAGR,EAAQ+I,GA0BxB,SAAoBxQ,EAAOyH,EAAQ+F,EAASgB,EAAYwB,EAAMQ,QACxClV,IAAd+S,IACAA,EAAY7O,EAAOzC,oBACvB,IAAIS,EAASwC,EAAM2I,IAAInL,SAAUoT,EAAc,GAAIC,EAAW,GAC9DpJ,EAAOkC,SAAQ,SAAU2G,GAAMM,EAAYN,EAAGF,OAAQ,KACtD,IAA6BU,EAAzBjT,EAAK2S,EAAOlE,YAChB,KAAOzO,GACHiT,EAASjT,EAAG6S,aAAa,UACrBE,EAAYlJ,eAAeoJ,GAC3BF,EAAYE,IAAU,EAEtBD,EAASnH,KAAK7L,GAClBA,EAAKA,EAAGyO,YAEZuE,EAASlH,SAAQ,SAAU9L,GAAM,OAAOmS,EAAKe,YAAYlT,MACzD4J,EAAOkC,SAAQ,SAAU2G,GAChBM,EAAYN,EAAGF,OAChBJ,EAAKT,YAgBjB,SAAqBvP,EAAO7F,EAAIqT,EAASgB,EAAYhR,GACjD,IACIK,EADAsS,EAAQhW,EAAGgW,MAAOjQ,EAAU/F,EAAG+F,QAASkQ,EAAOjW,EAAGiW,KAEtD,GAAID,EAAMtO,MACNhE,EAyCR,SAAqBmT,EAASlW,EAAK+G,EAAOrE,GACtC,IAAI0J,EAAI4I,EAAOhV,EAAK0C,GAASyT,EAAOzT,EAAOC,MAAQ,GAAKoE,EAAMgN,OAAS,GAAIqC,EAAOrP,EAAM/E,MAAM,IAAqB,WAAf+E,EAAMhF,KAAoB,IAAMgF,EAAMhF,KAAK,IAAI8J,cACnJ,OAAOqI,EAAc7P,EAAc,SAAU,CACzCF,UAAW4C,EAAMhF,KAAO,IAAMgF,EAAM/E,MACpCX,EAAG+K,EAAE,GAAK+J,EAAO,EACjBvK,EAAGQ,EAAE,GAAK+J,EAAO,EACjBxT,MAAOwT,EACPvT,OAAQuT,EACRE,KAAMH,EAAUE,EAAO,SAjDlBE,CAAYpR,EAAMwH,SAAS7G,OAAOqQ,QAAS9B,EAAO1P,EAAOzE,QAAQoV,EAAM1P,MAAOT,EAAM6D,aAAcsM,EAAMtO,MAAOrE,OACnH,CACD,IAAIiD,EAAOyO,EAAO1P,EAAOzE,QAAQoV,EAAM1P,MAAOT,EAAM6D,aACpD,GAAIsM,EAAM1P,MAAQ0P,EAAMzP,KAAM,CAC1B,IAAIuN,EAAQT,EAAQ2C,EAAMlC,OACtBkC,EAAMzB,YACNT,EAAQ0B,EAAgB1B,EAAOkC,EAAMzB,YACzC7Q,EAoBZ,SAAqBoQ,EAAOxN,EAAMC,EAAMR,EAASmR,EAAS7T,GACtD,IAAIiR,EAmER,SAAqBjR,EAAQ6T,GACzB,OAAOhD,EAAY,GAAMgD,EAAU,GAAK,IAAM,IAAM7T,EAAOC,MApEnD6T,CAAY9T,EAAQ6T,IAAYnR,GAAU0N,EAAIkC,EAAOrP,EAAMjD,GAASiI,EAAIqK,EAAOpP,EAAMlD,GAAS+T,EAAK9L,EAAE,GAAKmI,EAAE,GAAI4D,EAAK/L,EAAE,GAAKmI,EAAE,GAAI6D,EAAQjV,KAAKkV,MAAMF,EAAID,GAAKI,EAAKnV,KAAKoV,IAAIH,GAAShD,EAAGoD,EAAKrV,KAAKsV,IAAIL,GAAShD,EACvN,OAAOO,EAAc7P,EAAc,QAAS,CACxC4S,OAAQ9D,EAAMnR,MACd,eAAgB8R,EAAUX,EAAO/N,EAAS1C,GAC1C,iBAAkB,QAClB,aAAc6Q,OAAY/S,EAAY,kBAAoB2S,EAAMnM,IAAM,IACtE8N,QAASA,EAAQ3B,EAAO/N,GACxB8R,GAAIpE,EAAE,GACNqE,GAAIrE,EAAE,GACNsE,GAAIzM,EAAE,GAAKkM,EACXQ,GAAI1M,EAAE,GAAKoM,IA/BFO,CAAYnE,EAAOxN,EAAMyO,EAAO1P,EAAOzE,QAAQoV,EAAMzP,MAAOV,EAAM6D,aAAc3D,EAASsO,EAAW2B,EAAMzP,MAAQ,EAAGlD,QAG1HK,EAKZ,SAAsBoQ,EAAOnT,EAAKoF,EAAS1C,GACvC,IAAI0J,EAAI4I,EAAOhV,EAAK0C,GAAS6U,EAqEjC,SAAqB7U,GACjB,IAAI8J,EAAO9J,EAAOC,MAAQ,IAC1B,MAAO,CAAC,EAAI6J,EAAM,EAAIA,GAvEgBgL,CAAY9U,GAAS+U,GAAU/U,EAAOC,MAAQD,EAAOE,QAAU,GACrG,OAAOsR,EAAc7P,EAAc,UAAW,CAC1C4S,OAAQ9D,EAAMnR,MACd,eAAgBuV,EAAOnS,EAAU,EAAI,GACrCsP,KAAM,OACNI,QAASA,EAAQ3B,EAAO/N,GACxBsS,GAAItL,EAAE,GACNuL,GAAIvL,EAAE,GACNtM,EAAG2X,EAASF,EAAO,GAAK,IAdfK,CAAalF,EAAQ2C,EAAMlC,OAAQxN,EAAMP,EAAS1C,GAG/D,OADAK,EAAG4R,aAAa,SAAUW,GACnBvS,EAjCkB8U,CAAY3S,EAAOsQ,EAAI9C,EAASgB,EAAYhR,OA1CrEoV,CAAW5S,EAAOyH,EAAQQ,EAAEuF,QAASgB,EAAYwB,EAAMQ,M,kBCjC3DqC,EAAOhZ,QAAU,CAAEiZ,OAAQ,MAAOC,SAAU,OAAQC,KAAM,CAAC,IAAK,IAAK,GAAI,OAAQ,4b,kBCAjFH,EAAOhZ,QAAU,CAAEiZ,OAAQ,MAAOC,SAAU,OAAQC,KAAM,CAAC,IAAK,IAAK,GAAI,OAAQ,u1E,kBCAjFH,EAAOhZ,QAAU,CAAEiZ,OAAQ,MAAOC,SAAU,cAAeC,KAAM,CAAC,IAAK,IAAK,GAAI,OAAQ,qZ,iCCCxFrZ,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtD,IAAImZ,EAAQ,EAAQ,KAChBC,EAAW,EAAQ,KACnBC,EAAU,EAAQ,KAClBC,EAAS,EAAQ,KACjBjT,EAAS,EAAQ,KACjBkT,EAAW,EAAQ,KACnBC,EAAM,EAAQ,KACd9K,EAAO,EAAQ,KAmCnB,SAAS+K,EAAehJ,GACpB,IAAIiJ,GAAY,EAChB,OAAO,WACCA,IAEJA,GAAY,EACZhL,EAAKpJ,KAAI,WACLmL,IACAiJ,GAAY,OAVxB3Z,EAAQ4Z,YAhCR,SAAqBlI,EAASnE,GAC1B,IAAIpH,EAAQmT,EAAQO,WAEpB,SAASC,IACL,IAAIC,EAAa5T,EAAM2I,KAAO3I,EAAM2I,IAAIkL,OACxCtI,EAAQG,UAAUC,IAAI,iBACtB,IAAInO,EAASgL,EAAKtN,MAAK,WAAc,OAAOqQ,EAAQuI,2BAChDC,EAAW/T,EAAMgU,WAAahU,EAAMwH,SAASyM,QAC7CjI,EAAWoH,EAAOnQ,QAAQsI,EAASvL,EAAO+T,OAAWzY,EAAYkC,KACjE+M,EAAY,SAAU2J,GACtBb,EAASpQ,QAAQjD,IACZkU,GAAWlI,EAASsH,KACrBA,EAAIvD,UAAU/P,EAAOgM,EAASsH,MAEtCtT,EAAM2I,IAAM,CACRqD,SAAUA,EACVxO,OAAQA,EACRoL,OAAQ2K,EAAehJ,GACvBA,UAAWA,EACXsJ,OAAQD,EACRG,SAAUA,GAEd/T,EAAMwH,SAAS+I,YAAc,GAC7BhG,GAAU,GACVpK,EAAOgU,UAAUnU,GACZ4T,IACD5T,EAAM2I,IAAIkL,OAAS1T,EAAOiU,aAAapU,EAAO2T,IAItD,OA5BAT,EAAS/L,UAAUnH,EAAOoH,GAAU,IA0BpCuM,IACUV,EAAMvX,MAAMsE,EAAO2T,K,iCCtCjCha,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtD,IAAIgR,EAAQ,EAAQ,KAChB1E,EAAQ,EAAQ,KAChB8M,EAAW,EAAQ,KACnBlI,EAAS,EAAQ,KACjBqJ,EAAS,EAAQ,KACjBC,EAAc,EAAQ,KAoF1Bza,EAAQ6B,MAnFR,SAAesE,EAAO2T,GAClB,SAAS/P,IACLkH,EAAMlH,kBAAkB5D,GACxB2T,IAGJ,MAAO,CACHpQ,IAAK,SAAU6D,GACPA,EAAOvD,aAAeuD,EAAOvD,cAAgB7D,EAAM6D,aACnDD,KACHwD,EAAOnB,IAAM+E,EAAOlC,KAAOkC,EAAOvC,SAAQ,SAAUzI,GAAS,OAAOkT,EAAS/L,UAAUnH,EAAOoH,KAAYpH,IAE/GA,MAAOA,EACPuU,OAAQ,WAAc,OAAOnO,EAAMI,MAAMxG,EAAMW,SAC/CiD,kBAAmBA,EACnBI,UAAW,SAAUrD,GACjBqK,EAAOlC,MAAK,SAAU9I,GAAS,OAAO8K,EAAM9G,UAAUhE,EAAOW,KAAYX,IAE7EuE,aAAc,SAAUzC,EAAKC,GACrBD,EACAkJ,EAAOlC,MAAK,SAAU9I,GAAS,OAAO8K,EAAMvG,aAAavE,EAAO8B,EAAKC,KAAW/B,GAC3EA,EAAMa,WACXiK,EAAMhK,SAASd,GACfA,EAAM2I,IAAIC,WAGlB7H,KAAM,SAAUN,EAAMC,GAClBsK,EAAOlC,MAAK,SAAU9I,GAAS,OAAO8K,EAAMtK,SAASR,EAAOS,EAAMC,KAAUV,IAEhF8L,SAAU,SAAUjK,EAAOC,GACvBkJ,EAAOlC,MAAK,SAAU9I,GAAS,OAAO8K,EAAMlJ,aAAa5B,EAAO6B,EAAOC,KAAS9B,IAEpF4E,YAAa,WACT,GAAI5E,EAAMC,WAAWC,QAAS,CAC1B,GAAI8K,EAAOlC,KAAKgC,EAAMlG,YAAa5E,GAC/B,OAAO,EACXA,EAAM2I,IAAIC,SAEd,OAAO,GAEX9D,YAAa,SAAUC,GACnB,GAAI/E,EAAMO,aAAaL,QAAS,CAC5B,IAAImC,EAASyI,EAAMhG,YAAY9E,EAAO+E,GAEtC,OADA/E,EAAM2I,IAAIC,SACHvG,EAEX,OAAO,GAEXmS,cAAe,WACXxJ,EAAOvC,OAAOqC,EAAM/K,aAAcC,IAEtCyU,cAAe,WACXzJ,EAAOvC,OAAOqC,EAAMzK,aAAcL,IAEtC2D,WAAY,WACRqH,EAAOvC,QAAO,SAAUzI,GAAS8K,EAAMnH,WAAW3D,GAAQqU,EAAOxY,OAAOmE,KAAWA,IAEvFlE,KAAM,WACFkP,EAAOvC,QAAO,SAAUzI,GAAS8K,EAAMhP,KAAKkE,GAAQqU,EAAOxY,OAAOmE,KAAWA,IAEjF0U,QAAS,SAAUC,GACfL,EAAYrR,QAAQjD,EAAO2U,IAE/BC,cAAe,SAAUnN,GACrBuD,EAAOvC,QAAO,SAAUzI,GAAS,OAAOA,EAAMwH,SAAS0I,WAAazI,IAAWzH,IAEnF6U,UAAW,SAAUpN,GACjBuD,EAAOvC,QAAO,SAAUzI,GAAS,OAAOA,EAAMwH,SAASC,OAASA,IAAWzH,IAE/EiF,eAAgB,SAAUnK,GACtB,OAAOgQ,EAAM7F,eAAenK,EAA2B,UAAtBkF,EAAM6D,YAAyB7D,EAAM2I,IAAInL,WAE9EmW,UAAWA,EACXxG,aAAc,SAAUtL,EAAOiT,EAAO/S,GAClCsS,EAAOlH,aAAanN,EAAO6B,EAAOiT,EAAO/S,IAE7CgT,QAAS,WACLjK,EAAMhP,KAAKkE,GACXA,EAAM2I,IAAIkL,QAAU7T,EAAM2I,IAAIkL,SAC9B7T,EAAM2I,IAAI2B,WAAY,M,iCCtFlC3Q,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtD,IAAI0O,EAAO,EAAQ,KACnB,SAASwM,EAAKpH,EAAGnI,GACb,OAAOjJ,KAAKyY,IAAIrH,EAAInI,GAKxB,IAAII,EAAS,SAAUmM,EAAIC,EAAIC,EAAIC,GAC/B,IAAI+C,EAAKF,EAAKhD,EAAIE,GACdiD,EAAKH,EAAK/C,EAAIE,GAClB,OAAe,IAAP+C,GAAmB,IAAPC,GAAqB,IAAPD,GAAmB,IAAPC,GAE9CrP,EAAS,SAAUkM,EAAIC,EAAIC,EAAIC,GAC/B,OAAO6C,EAAKhD,EAAIE,KAAQ8C,EAAK/C,EAAIE,IAEjC5Q,EAAO,SAAUyQ,EAAIC,EAAIC,EAAIC,GAC7B,OAAOH,IAAOE,GAAMD,IAAOE,GAE3BpM,EAAQ,SAAUiM,EAAIC,EAAIC,EAAIC,GAC9B,OAAOrM,EAAOkM,EAAIC,EAAIC,EAAIC,IAAO5Q,EAAKyQ,EAAIC,EAAIC,EAAIC,IAuCtDtY,EAAQoJ,QA3BR,SAAiBtC,EAAQmB,EAAKsT,GAC1B,IACIC,EA7BMvY,EA4BN+E,EAAQlB,EAAOmB,GAAMhH,EAAM0N,EAAKzN,QAAQ+G,GAE5C,OAAQD,EAAMhF,MACV,IAAK,OA/BCC,EAgCc+E,EAAM/E,MAAtBuY,EA/BD,SAAUrD,EAAIC,EAAIC,EAAIC,GAAM,OAAO6C,EAAKhD,EAAIE,GAAM,IAAgB,UAAVpV,EAAqBqV,IAAOF,EAAK,GAAMA,GAAM,GAAKE,IAAQF,EAAK,GAAMD,IAAOE,EAAQC,IAAOF,EAAK,GAAMA,GAAM,GAAKE,IAAQF,EAAK,GAAMD,IAAOE,IAgClM,MACJ,IAAK,SACDmD,EAAWxP,EACX,MACJ,IAAK,SACDwP,EAAWvP,EACX,MACJ,IAAK,OACDuP,EAAW9T,EACX,MACJ,IAAK,QACD8T,EAAWtP,EACX,MACJ,IAAK,OACDsP,EA9BZ,SAAcvY,EAAOwY,EAAWF,GAC5B,OAAO,SAAUpD,EAAIC,EAAIC,EAAIC,GAAM,OAAQ6C,EAAKhD,EAAIE,GAAM,GAAK8C,EAAK/C,EAAIE,GAAM,GAAOiD,GAAanD,IAAOE,GAAMF,KAAkB,UAAVnV,EAAoB,EAAI,KAAe,IAAPkV,IAAoB,IAAPE,GAAmB,IAAPA,IAAc1J,EAAKvM,UAAUqZ,EAAWpD,KA6BrMjR,CAAKY,EAAM/E,MA3BlC,SAAqB6D,EAAQ7D,GACzB,IAAI+E,EACJ,OAAOlI,OAAOgb,KAAKhU,GAAQqH,QAAO,SAAUlG,GAExC,OADAD,EAAQlB,EAAOmB,KACCD,EAAM/E,QAAUA,GAAwB,SAAf+E,EAAMhF,QAChDpC,KAAI,SAAUqH,GAAO,OAAO0G,EAAKzN,QAAQ+G,GAAK,MAsBZyT,CAAY5U,EAAQkB,EAAM/E,OAAQsY,GAGvE,OAAO5M,EAAKtO,QAAQO,IAAI+N,EAAKzN,SAASiN,QAAO,SAAUzL,GACnD,OAAQzB,EAAI,KAAOyB,EAAK,IAAMzB,EAAI,KAAOyB,EAAK,KAAO8Y,EAASva,EAAI,GAAIA,EAAI,GAAIyB,EAAK,GAAIA,EAAK,OAC7F9B,IAAI+N,EAAK3N,W,iCC5ChB,SAAS2a,EAASxV,EAAOyV,GACjBzV,EAAM0V,YACFD,EACAzV,EAAM0V,UAAUD,MAAQA,EAExBzV,EAAM0V,eAAYpa,EACtB0E,EAAM2I,IAAIC,UAnBlBjP,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IAYtDD,EAAQoJ,QAXR,SAAmBjD,EAAO2U,GACtB3U,EAAM0V,UAAY,CACdD,MAAO,EACPd,KAAMA,GAEV3U,EAAM2I,IAAIC,SACVtJ,YAAW,WACPkW,EAASxV,EAAO,GAChBV,YAAW,WAAc,OAAOkW,EAASxV,OAAO1E,KAAe,OAChE,O,iCCVP3B,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtD,IAAImM,EAAM,EAAQ,KACdzG,EAAS,EAAQ,KA6ErB3F,EAAQ6Z,SA5ER,WACI,MAAO,CACH/S,OAAQsF,EAAID,KAAKC,EAAIZ,SACrBxB,YAAa,QACb1B,UAAW,QACXwT,aAAa,EACb3U,YAAY,EACZgT,UAAU,EACV4B,oBAAoB,EACpBC,WAAW,EACXC,gBAAgB,EAChBC,UAAU,EACVC,UAAW,CACPvU,UAAU,EACVC,OAAO,GAEXY,UAAW,CACPoB,SAAS,EACTiE,SAAU,KAEd1F,QAAS,CACLwB,MAAM,EACN3G,MAAO,OACPmZ,WAAW,EACX9V,OAAQ,GACRyH,YAAY,GAEhB3H,WAAY,CACRyD,SAAS,EACTuS,WAAW,EACX/S,QAAQ,EACR/C,OAAQ,IAEZI,aAAc,CACVmD,SAAS,EACTvD,OAAQ,IAEZ2D,UAAW,CACPJ,SAAS,EACT4H,SAAU,EACV0B,cAAc,EACdD,aAAa,EACbmJ,WAAW,EACX3I,iBAAiB,GAErB/I,WAAY,CACRd,SAAS,GAEbZ,MAAO,CACH2B,UAAW,iBAAkBzH,SAEjCmD,OAAQ,GACRqH,SAAU,CACN9D,SAAS,EACTuQ,SAAS,EACTvH,cAAc,EACdjF,OAAQ,GACRyI,WAAY,GACZ1C,QAAS,CACL2I,MAAO,CAAErU,IAAK,IAAKhF,MAAO,UAAW8S,QAAS,EAAGhB,UAAW,IAC5DwH,IAAK,CAAEtU,IAAK,IAAKhF,MAAO,UAAW8S,QAAS,EAAGhB,UAAW,IAC1DyH,KAAM,CAAEvU,IAAK,IAAKhF,MAAO,UAAW8S,QAAS,EAAGhB,UAAW,IAC3D0H,OAAQ,CAAExU,IAAK,IAAKhF,MAAO,UAAW8S,QAAS,EAAGhB,UAAW,IAC7D2H,SAAU,CAAEzU,IAAK,KAAMhF,MAAO,UAAW8S,QAAS,GAAKhB,UAAW,IAClE4H,UAAW,CAAE1U,IAAK,KAAMhF,MAAO,UAAW8S,QAAS,GAAKhB,UAAW,IACnE6H,QAAS,CAAE3U,IAAK,KAAMhF,MAAO,UAAW8S,QAAS,GAAKhB,UAAW,IACjE8H,SAAU,CAAE5U,IAAK,MAAOhF,MAAO,UAAW8S,QAAS,IAAMhB,UAAW,KAExEjO,OAAQ,CACJqQ,QAAS,+CAEbT,YAAa,IAEjB7N,KAAMlD,EAAOhE,W,iCC5ErB7B,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtD,IAAI0F,EAAS,EAAQ,KACjBmX,EAAU,EAAQ,KAClBC,EAAQ,EAAQ,KAkCpB,SAASC,EAAaC,EAAO7X,GACzB,IACI9D,EADA0C,EAAK2B,EAAOT,SAAS,SAAUE,GAEnC,IAAK,IAAIqJ,KAAKwO,GACV3b,EAAIqE,EAAOT,SAAS,UAClBgY,YAAcD,EAAMxO,GACtBzK,EAAG0R,YAAYpU,GAEnB,OAAO0C,EATXhE,EAAQoJ,QAhCR,SAAcsI,EAASzE,EAAGtJ,GACtB+N,EAAQyL,UAAY,GACpBzL,EAAQG,UAAUC,IAAI,iBACtBnM,EAAOxF,OAAO2P,SAAQ,SAAUjP,GAC5B6Q,EAAQG,UAAUuL,OAAO,eAAiBvc,EAAGoM,EAAEjD,cAAgBnJ,MAEnE6Q,EAAQG,UAAUuL,OAAO,eAAgBnQ,EAAEkN,UAC3C,IAEIV,EAWArH,EAbAnB,EAAQtL,EAAOT,SAAS,MAAO,YAQnC,GAPAwM,EAAQgE,YAAYzE,GAEhBhE,EAAEU,SAASyM,SAAWzW,KACtB8V,EAAMsD,EAAMzX,cAAc,QACtBoQ,YAAYqH,EAAMzX,cAAc,SACpCoM,EAAQgE,YAAY+D,IAEpBxM,EAAE6O,YAAa,CACf,IAAIuB,EAAgC,UAAlBpQ,EAAEjD,YAA0B,SAAW,GACzD0H,EAAQgE,YAAYsH,EAAaF,EAAQhc,MAAO,QAAUuc,IAC1D3L,EAAQgE,YAAYsH,EAAaF,EAAQnc,MAAO,QAAU0c,IAQ9D,OALI1Z,GAAUsJ,EAAEhD,UAAUoS,YACtBjK,EAAQzM,EAAOT,SAAS,QAAS,SACjCS,EAAOpB,WAAW6N,GAAO,GACzBV,EAAQgE,YAAYtD,IAEjB,CACHnB,MAAOA,EACPmB,MAAOA,EACPqH,IAAKA,K,iCCjCb3Z,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtD,IAAIqd,EAAO,EAAQ,KACfC,EAAO,EAAQ,KACf5X,EAAS,EAAQ,KAiCrB,SAAS6X,EAAWxZ,EAAIyZ,EAAWC,EAAUC,GAEzC,OADA3Z,EAAG4Z,iBAAiBH,EAAWC,EAAUC,GAClC,WAAc,OAAO3Z,EAAG6Z,oBAAoBJ,EAAWC,IAgBlE,SAASI,EAAW7Q,EAAG8Q,EAAUC,GAC7B,OAAO,SAAUtZ,GACTA,EAAEsP,UAAYrO,EAAOZ,cAAcL,GAC/BuI,EAAEU,SAAS9D,SACXmU,EAAS/Q,EAAGvI,GAEVuI,EAAEkN,UACR4D,EAAS9Q,EAAGvI,IA/CxB1E,EAAQsa,UAVR,SAAmBrN,GACf,IAAIA,EAAEkN,SAAN,CAEA,IAAI8D,EAAUhR,EAAE6B,IAAIqD,SAASlB,MAAOiN,EAiCxC,SAAyBjR,GACrB,OAAO,SAAUvI,GACTuI,EAAEhD,UAAU5D,QACZiX,EAAKtb,OAAOiL,GACPA,EAAEU,SAAStH,QAChBkX,EAAKvb,OAAOiL,GACPvI,EAAEsP,UAAYrO,EAAOZ,cAAcL,GACpCuI,EAAEU,SAAS9D,SACX0T,EAAK1b,MAAMoL,EAAGvI,GAEZuI,EAAEkN,UACRmD,EAAKzb,MAAMoL,EAAGvI,IA5CwByZ,CAAgBlR,GAC9DgR,EAAQL,iBAAiB,aAAcM,GACvCD,EAAQL,iBAAiB,YAAaM,IAClCjR,EAAE8O,oBAAsB9O,EAAEU,SAAS9D,UACnCoU,EAAQL,iBAAiB,eAAe,SAAUlZ,GAAK,OAAOA,EAAEgO,sBAwBxE1S,EAAQua,aApBR,SAAsBtN,EAAG6M,GACrB,IAAIsE,EAAU,GACd,IAAKnR,EAAE6B,IAAIoL,UAAYjN,EAAE+O,UAAW,CAKhCoC,EAAQvO,KAAK2N,EAAWnY,SAASgZ,KAAM,sBAJxB,WACXpR,EAAE6B,IAAInL,OAAOjC,QACbiE,EAAOJ,IAAIuU,OAInB,IAAK7M,EAAEkN,SAAU,CACb,IAAImE,EAAWR,EAAW7Q,EAAGqQ,EAAKpW,KAAMqW,EAAKrW,MACzCqX,EAAUT,EAAW7Q,EAAGqQ,EAAK/J,IAAKgK,EAAKhK,KAC3C,CAAC,YAAa,aAAazD,SAAQ,SAAU0O,GAAM,OAAOJ,EAAQvO,KAAK2N,EAAWnY,SAAUmZ,EAAIF,OAChG,CAAC,WAAY,WAAWxO,SAAQ,SAAU0O,GAAM,OAAOJ,EAAQvO,KAAK2N,EAAWnY,SAAUmZ,EAAID,OAC7F,IAAIE,EAAW,WAAc,OAAOxR,EAAE6B,IAAInL,OAAOjC,SACjD0c,EAAQvO,KAAK2N,EAAWra,OAAQ,SAAUsb,EAAU,CAAEC,SAAS,KAC/DN,EAAQvO,KAAK2N,EAAWra,OAAQ,SAAUsb,EAAU,CAAEC,SAAS,KAEnE,OAAO,WAAc,OAAON,EAAQtO,SAAQ,SAAUxO,GAAK,OAAOA,U,iCCjCtExB,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IACtD,IAAI0F,EAAS,EAAQ,KACjBgJ,EAAO,EAAQ,KAqInB,SAASgQ,EAAY3a,GACjB,MAAsB,UAAfA,EAAGmB,QAEd,SAASyZ,EAAa5a,GAClB,MAAsB,WAAfA,EAAGmB,QAEd,SAAS0Z,EAAY5R,EAAG6R,GACpB,IAAK,IAAIrQ,KAAKqQ,EACV7R,EAAE6B,IAAIqD,SAASlB,MAAMiG,YAAY4H,EAAMrQ,IAE/C,SAASsQ,EAAU9d,EAAKsC,GACpB,IAAIyb,EAAI,EAAmB,GAAd/d,EAAI,GAAK,IAAU,EAAIA,EAAI,IAGxC,OAFIsC,IACAyb,EAAI,GAAKA,GACNA,EAAI,GAEf,SAASC,EAAYjX,GACjB,OAAOA,EAAM/E,MAAQ,IAAM+E,EAAMhF,KAwCrC,SAASkc,EAAUC,EAASlX,EAAKmX,GACzBD,EAAQlX,GACRkX,EAAQlX,IAAQ,IAAMmX,EAEtBD,EAAQlX,GAAOmX,EA9DvBpf,EAAQoJ,QAnIR,SAAgB6D,GACZ,IACI9L,EAAGuK,EAAG1H,EAAIqb,EAAYC,EAAarQ,EAAMsQ,EAAQC,EAASC,EAAMC,EAASC,EADzEpc,EAA4B,UAAlB0J,EAAEjD,YAAyB4V,EAAiB3S,EAAE6B,IAAIoL,SAAWvL,EAAK7K,kBAAoB6K,EAAKjL,kBAAkBuJ,EAAE6B,IAAInL,UAAWkc,EAAY5S,EAAE6B,IAAIoL,SAAWvL,EAAKxK,aAAewK,EAAK5K,aAAcka,EAAUhR,EAAE6B,IAAIqD,SAASlB,MAAOnK,EAASmG,EAAEnG,OAAQgZ,EAAU7S,EAAExE,UAAUpC,QAASkJ,EAAQuQ,EAAUA,EAAQ3Q,KAAKI,MAAQ,GAAIE,EAAUqQ,EAAUA,EAAQ3Q,KAAKM,QAAU,GAAIsQ,EAAU9S,EAAEhD,UAAU5D,QAAS8Y,EAsJ/Z,SAA8BlS,GAC1B,IACIwB,EAAGtN,EADHge,EAAU,GAEd,GAAIlS,EAAErF,UAAYqF,EAAEkP,UAAUvU,SAC1B,IAAK6G,KAAKxB,EAAErF,SACRsX,EAAUC,EAASlS,EAAErF,SAAS6G,GAAI,aAEtCxB,EAAEpF,OAASoF,EAAEkP,UAAUtU,OACvBqX,EAAUC,EAASlS,EAAEpF,MAAO,SAChC,GAAIoF,EAAEjG,WACFkY,EAAUC,EAASlS,EAAEjG,SAAU,YAC3BiG,EAAE7E,QAAQgU,WAAW,CACrB,IAAI/T,EAAQ4E,EAAE7E,QAAQC,OAAS4E,EAAE7E,QAAQC,MAAM4E,EAAEjG,UACjD,GAAIqB,EACA,IAAKoG,KAAKpG,EACNlH,EAAIkH,EAAMoG,GACVyQ,EAAUC,EAAShe,EAAG,aAAe8L,EAAEnG,OAAO3F,GAAK,MAAQ,KAEnE,IAAI6e,EAAS/S,EAAE7G,WAAWiC,MAC1B,GAAI2X,EACA,IAAKvR,KAAKuR,EACN7e,EAAI6e,EAAOvR,GACXyQ,EAAUC,EAAShe,EAAG,gBAAkB8L,EAAEnG,OAAO3F,GAAK,MAAQ,KAI9E,IAAI4H,EAAUkE,EAAE7G,WAAWC,QAC3B,GAAI0C,EACA,IAAK0F,KAAK1F,EACNmW,EAAUC,EAASpW,EAAQ0F,GAAI,wBAC9BxB,EAAEvG,aAAaL,SACpB6Y,EAAUC,EAASlS,EAAEvG,aAAaL,QAAQ4B,IAAK,mBACnD,IAAIoF,EAAIJ,EAAE4O,UACV,GAAIxO,EACA,IAAKoB,KAAKpB,EAAEyN,KACRoE,EAAUC,EAAS9R,EAAEyN,KAAKrM,GAAI,YAAcpB,EAAEuO,OACtD,OAAOuD,EA1L8Zc,CAAqBhT,GAAIiT,EAAa,GAAIC,EAAc,GAAIC,EAAc,GAAIC,EAAe,GAAIC,EAAaxgB,OAAOgb,KAAKhU,GAG/hB,IADA9C,EAAKia,EAAQ1L,WACNvO,GAAI,CAEP,GADA7C,EAAI6C,EAAGwO,MACHmM,EAAY3a,GAcZ,GAbAqb,EAAavY,EAAO3F,GACpB8N,EAAOM,EAAMpO,GACboe,EAAS9P,EAAQtO,GACjBme,EAActb,EAAGuc,SACbvc,EAAG4N,YAAgBmO,GAAWA,EAAQnZ,OAASzF,IAC/C6C,EAAG6N,UAAU2O,OAAO,YACpBX,EAAU7b,EAAI4b,EAAeja,EAAOzE,QAAQC,GAAIoC,IAChDS,EAAG4N,YAAa,IAEf2N,GAAUvb,EAAGyc,WACdzc,EAAGyc,UAAW,EACdzc,EAAG6N,UAAU2O,OAAO,WAEpBnB,EAAY,CACZ,GAAIpQ,GAAQjL,EAAG0c,aAAepB,IAAgBL,EAAYI,IAClDpe,EAAM0E,EAAOzE,QAAQC,IACrB,IAAM8N,EAAK,GACfhO,EAAI,IAAMgO,EAAK,GACfjL,EAAG6N,UAAUC,IAAI,QACjB+N,EAAU7b,EAAI4b,EAAe3e,EAAKsC,SAE7BS,EAAG0c,cACR1c,EAAG0c,aAAc,EACjB1c,EAAG6N,UAAU2O,OAAO,QACpBX,EAAU7b,EAAI4b,EAAeja,EAAOzE,QAAQC,GAAIoC,IAC5C0J,EAAEgP,iBACFjY,EAAGC,MAAM0c,OAAS5B,EAAUpZ,EAAOzE,QAAQC,GAAIoC,KAEnD+b,IAAgBL,EAAYI,IAAiBE,GAAWvb,EAAGyc,SAIvDlB,GAAUD,IAAgBL,EAAYM,IACtCvb,EAAG6N,UAAUC,IAAI,UACjB9N,EAAGyc,UAAW,GAGVL,EAAYd,GACZc,EAAYd,GAAazP,KAAK7L,GAE9Boc,EAAYd,GAAe,CAACtb,GAXpCkc,EAAW/e,IAAK,OAgBhBif,EAAYd,GACZc,EAAYd,GAAazP,KAAK7L,GAE9Boc,EAAYd,GAAe,CAACtb,QAGnC,GAAI4a,EAAa5a,GAAK,CACvB,IAAI4c,EAAK5c,EAAGoB,UACR+Z,EAAQhe,KAAOyf,EACfT,EAAYhf,IAAK,EACZkf,EAAaO,GAClBP,EAAaO,GAAI/Q,KAAK7L,GAEtBqc,EAAaO,GAAM,CAAC5c,GAE5BA,EAAKA,EAAGyO,YAEZ,IAAK,IAAIoO,KAAM1B,EACX,IAAKgB,EAAYU,GAAK,CAElBlB,GADAD,EAAUW,EAAalB,EAAQ0B,MACbnB,EAAQoB,MAC1B,IAAI/O,EAAc6N,EAAeja,EAAOzE,QAAQ2f,GAAKtd,GACrD,GAAIoc,EACAA,EAAKnN,MAAQqO,EACbhB,EAAUF,EAAM5N,OAEf,CACD,IAAIgP,EAAapb,EAAOT,SAAS,SAAUia,EAAQ0B,IACnDE,EAAWvO,MAAQqO,EACnBhB,EAAUkB,EAAYhP,GACtBkM,EAAQ+C,aAAaD,EAAY9C,EAAQ1L,aAIrD,IAAK,IAAI0O,KAAKX,EAIV,GAFA5U,EAAI5E,EADJ3F,EAAImf,EAAWW,IAEfhS,EAAOM,EAAMpO,IACR+e,EAAW/e,GAGZ,GADAse,GADAD,EAAUY,EAAYnB,EAAYvT,MAChB8T,EAAQsB,MAChB,CACNrB,EAAKjN,MAAQrR,EACTse,EAAKgB,WACLhB,EAAK5N,UAAU2O,OAAO,UACtBf,EAAKgB,UAAW,GAEpB,IAAIxf,EAAM0E,EAAOzE,QAAQC,GACrB8L,EAAEgP,iBACFwD,EAAKxb,MAAM0c,OAAS5B,EAAU9d,EAAKsC,IACnC0L,IACAwQ,EAAKiB,aAAc,EACnBjB,EAAK5N,UAAUC,IAAI,QACnB7Q,EAAI,IAAMgO,EAAK,GACfhO,EAAI,IAAMgO,EAAK,IAEnB4Q,EAAUJ,EAAMG,EAAe3e,EAAKsC,QAEnC,CACD,IAAI2d,EAAYjC,EAAYvT,GAAIyV,EAAYxb,EAAOT,SAAS,QAASgc,GAAYjgB,EAAM0E,EAAOzE,QAAQC,GACtGggB,EAAUZ,QAAUW,EACpBC,EAAU3O,MAAQrR,EACd8N,IACAkS,EAAUT,aAAc,EACxBzf,EAAI,IAAMgO,EAAK,GACfhO,EAAI,IAAMgO,EAAK,IAEnB4Q,EAAUsB,EAAWvB,EAAe3e,EAAKsC,IACrC0J,EAAEgP,iBACFkF,EAAUld,MAAM0c,OAAS5B,EAAU9d,EAAKsC,IAC5C0a,EAAQvI,YAAYyL,GAIhC,IAAK,IAAI1S,KAAK2R,EACVvB,EAAY5R,EAAGmT,EAAY3R,IAC/B,IAAK,IAAIA,KAAK4R,EACVxB,EAAY5R,EAAGoT,EAAa5R,M,oBCrIpC,IAAI2S,EAAW,EAAQ,IACnBhU,EAAW,EAAQ,IAmEvB4L,EAAOhZ,QAlBP,SAAkBqhB,EAAMC,EAAM3D,GAC5B,IAAI4D,GAAU,EACVC,GAAW,EAEf,GAAmB,mBAARH,EACT,MAAM,IAAII,UAnDQ,uBAyDpB,OAJIrU,EAASuQ,KACX4D,EAAU,YAAa5D,IAAYA,EAAQ4D,QAAUA,EACrDC,EAAW,aAAc7D,IAAYA,EAAQ6D,SAAWA,GAEnDJ,EAASC,EAAMC,EAAM,CAC1B,QAAWC,EACX,QAAWD,EACX,SAAYE,M,iCChEhB,WA0Fe,IAxFf,SAA2BE,QACZ,IAATA,IACFA,EAAO,IAMT,IAAIC,EAAa,iBAAO,MAIpBC,EAAWF,EAAKE,SAChBC,EAAc,sBAAOpgB,GACzBogB,EAAYxb,QAAUub,EAEtB,IAAIE,EAAoB,mBACpBC,EAAML,EAAKK,KAAOJ,EAElBK,EAAY,mBAAS,CACvBpe,WAAOnC,EACPoC,YAAQpC,IAEN2V,EAAO4K,EAAU,GACjBC,EAAUD,EAAU,GAGpBE,EAAW,iBAAO,CACpBte,WAAOnC,EACPoC,YAAQpC,IAkDV,OAhDA,qBAAU,WACJqgB,EAAkBzb,UAItByb,EAAkBzb,QAAU,IAAI8b,gBAAe,SAAUC,GACvD,GAAK7hB,MAAM8hB,QAAQD,IAMdA,EAAQnc,OAAb,CAIA,IAAIqc,EAAQF,EAAQ,GAEhBG,EAAW5f,KAAKqT,MAAMsM,EAAME,YAAY5e,OACxC6e,EAAY9f,KAAKqT,MAAMsM,EAAME,YAAY3e,QAE7C,GAAIqe,EAAS7b,QAAQzC,QAAU2e,GAAYL,EAAS7b,QAAQxC,SAAW4e,EAAW,CAChF,IAAIC,EAAU,CACZ9e,MAAO2e,EACP1e,OAAQ4e,GAGNZ,EAAYxb,QACdwb,EAAYxb,QAAQqc,IAEpBR,EAAS7b,QAAQzC,MAAQ2e,EACzBL,EAAS7b,QAAQxC,OAAS4e,EAC1BR,EAAQS,YAIb,IACH,qBAAU,WACR,GAAmB,iBAARX,GAA4B,OAARA,GAAkBA,EAAI1b,mBAAmBsc,QAAxE,CAIA,IAAIjR,EAAUqQ,EAAI1b,QAElB,OADAyb,EAAkBzb,QAAQuc,QAAQlR,GAC3B,WACL,OAAOoQ,EAAkBzb,QAAQwc,UAAUnR,OAE5C,CAACqQ,IACG,mBAAQ,WACb,MAAO,CACLA,IAAKA,EACLne,MAAOwT,EAAKxT,MACZC,OAAQuT,EAAKvT,UAEd,CAACke,EAAK3K,EAAOA,EAAKxT,MAAQ,KAAMwT,EAAOA,EAAKvT,OAAS","file":"1.eebcd14ed16c536391f1.js","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar cg = require(\"./types\");\nexports.colors = ['white', 'black'];\nexports.invRanks = [8, 7, 6, 5, 4, 3, 2, 1];\nexports.allKeys = (_a = Array.prototype).concat.apply(_a, cg.files.map(function (c) { return cg.ranks.map(function (r) { return c + r; }); }));\nexports.pos2key = function (pos) { return exports.allKeys[8 * pos[0] + pos[1] - 9]; };\nexports.key2pos = function (k) { return [k.charCodeAt(0) - 96, k.charCodeAt(1) - 48]; };\nfunction memo(f) {\n    var v;\n    var ret = function () {\n        if (v === undefined)\n            v = f();\n        return v;\n    };\n    ret.clear = function () { v = undefined; };\n    return ret;\n}\nexports.memo = memo;\nexports.timer = function () {\n    var startAt;\n    return {\n        start: function () { startAt = Date.now(); },\n        cancel: function () { startAt = undefined; },\n        stop: function () {\n            if (!startAt)\n                return 0;\n            var time = Date.now() - startAt;\n            startAt = undefined;\n            return time;\n        }\n    };\n};\nexports.opposite = function (c) { return c === 'white' ? 'black' : 'white'; };\nfunction containsX(xs, x) {\n    return xs !== undefined && xs.indexOf(x) !== -1;\n}\nexports.containsX = containsX;\nexports.distanceSq = function (pos1, pos2) {\n    return Math.pow(pos1[0] - pos2[0], 2) + Math.pow(pos1[1] - pos2[1], 2);\n};\nexports.samePiece = function (p1, p2) {\n    return p1.role === p2.role && p1.color === p2.color;\n};\nexports.computeIsTrident = function () { return window.navigator.userAgent.indexOf('Trident/') > -1; };\nvar posToTranslateBase = function (pos, asWhite, xFactor, yFactor) { return [\n    (asWhite ? pos[0] - 1 : 8 - pos[0]) * xFactor,\n    (asWhite ? 8 - pos[1] : pos[1] - 1) * yFactor\n]; };\nexports.posToTranslateAbs = function (bounds) {\n    var xFactor = bounds.width / 8, yFactor = bounds.height / 8;\n    return function (pos, asWhite) { return posToTranslateBase(pos, asWhite, xFactor, yFactor); };\n};\nexports.posToTranslateRel = function (pos, asWhite) { return posToTranslateBase(pos, asWhite, 12.5, 12.5); };\nexports.translateAbs = function (el, pos) {\n    el.style.transform = \"translate(\" + pos[0] + \"px,\" + pos[1] + \"px)\";\n};\nexports.translateRel = function (el, percents) {\n    el.style.left = percents[0] + '%';\n    el.style.top = percents[1] + '%';\n};\nexports.setVisible = function (el, v) {\n    el.style.visibility = v ? 'visible' : 'hidden';\n};\nexports.eventPosition = function (e) {\n    if (e.clientX || e.clientX === 0)\n        return [e.clientX, e.clientY];\n    if (e.touches && e.targetTouches[0])\n        return [e.targetTouches[0].clientX, e.targetTouches[0].clientY];\n    return undefined;\n};\nexports.isRightButton = function (e) { return e.buttons === 2 || e.button === 2; };\nexports.createEl = function (tagName, className) {\n    var el = document.createElement(tagName);\n    if (className)\n        el.className = className;\n    return el;\n};\nexports.raf = (window.requestAnimationFrame || window.setTimeout).bind(window);\nvar _a;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"./util\");\nvar premove_1 = require(\"./premove\");\nfunction callUserFunction(f) {\n    var args = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        args[_i - 1] = arguments[_i];\n    }\n    if (f)\n        setTimeout(function () { return f.apply(void 0, args); }, 1);\n}\nexports.callUserFunction = callUserFunction;\nfunction toggleOrientation(state) {\n    state.orientation = util_1.opposite(state.orientation);\n    state.animation.current =\n        state.draggable.current =\n            state.selected = undefined;\n}\nexports.toggleOrientation = toggleOrientation;\nfunction reset(state) {\n    state.lastMove = undefined;\n    unselect(state);\n    unsetPremove(state);\n    unsetPredrop(state);\n}\nexports.reset = reset;\nfunction setPieces(state, pieces) {\n    for (var key in pieces) {\n        var piece = pieces[key];\n        if (piece)\n            state.pieces[key] = piece;\n        else\n            delete state.pieces[key];\n    }\n}\nexports.setPieces = setPieces;\nfunction setCheck(state, color) {\n    if (color === true)\n        color = state.turnColor;\n    if (!color)\n        state.check = undefined;\n    else\n        for (var k in state.pieces) {\n            if (state.pieces[k].role === 'king' && state.pieces[k].color === color) {\n                state.check = k;\n            }\n        }\n}\nexports.setCheck = setCheck;\nfunction setPremove(state, orig, dest, meta) {\n    unsetPredrop(state);\n    state.premovable.current = [orig, dest];\n    callUserFunction(state.premovable.events.set, orig, dest, meta);\n}\nfunction unsetPremove(state) {\n    if (state.premovable.current) {\n        state.premovable.current = undefined;\n        callUserFunction(state.premovable.events.unset);\n    }\n}\nexports.unsetPremove = unsetPremove;\nfunction setPredrop(state, role, key) {\n    unsetPremove(state);\n    state.predroppable.current = {\n        role: role,\n        key: key\n    };\n    callUserFunction(state.predroppable.events.set, role, key);\n}\nfunction unsetPredrop(state) {\n    var pd = state.predroppable;\n    if (pd.current) {\n        pd.current = undefined;\n        callUserFunction(pd.events.unset);\n    }\n}\nexports.unsetPredrop = unsetPredrop;\nfunction tryAutoCastle(state, orig, dest) {\n    if (!state.autoCastle)\n        return false;\n    var king = state.pieces[orig];\n    if (king.role !== 'king')\n        return false;\n    var origPos = util_1.key2pos(orig);\n    if (origPos[0] !== 5)\n        return false;\n    if (origPos[1] !== 1 && origPos[1] !== 8)\n        return false;\n    var destPos = util_1.key2pos(dest);\n    var oldRookPos, newRookPos, newKingPos;\n    if (destPos[0] === 7 || destPos[0] === 8) {\n        oldRookPos = util_1.pos2key([8, origPos[1]]);\n        newRookPos = util_1.pos2key([6, origPos[1]]);\n        newKingPos = util_1.pos2key([7, origPos[1]]);\n    }\n    else if (destPos[0] === 3 || destPos[0] === 1) {\n        oldRookPos = util_1.pos2key([1, origPos[1]]);\n        newRookPos = util_1.pos2key([4, origPos[1]]);\n        newKingPos = util_1.pos2key([3, origPos[1]]);\n    }\n    else\n        return false;\n    var rook = state.pieces[oldRookPos];\n    if (rook.role !== 'rook')\n        return false;\n    delete state.pieces[orig];\n    delete state.pieces[oldRookPos];\n    state.pieces[newKingPos] = king;\n    state.pieces[newRookPos] = rook;\n    return true;\n}\nfunction baseMove(state, orig, dest) {\n    if (orig === dest || !state.pieces[orig])\n        return false;\n    var captured = (state.pieces[dest] &&\n        state.pieces[dest].color !== state.pieces[orig].color) ? state.pieces[dest] : undefined;\n    if (dest == state.selected)\n        unselect(state);\n    callUserFunction(state.events.move, orig, dest, captured);\n    if (!tryAutoCastle(state, orig, dest)) {\n        state.pieces[dest] = state.pieces[orig];\n        delete state.pieces[orig];\n    }\n    state.lastMove = [orig, dest];\n    state.check = undefined;\n    callUserFunction(state.events.change);\n    return captured || true;\n}\nexports.baseMove = baseMove;\nfunction baseNewPiece(state, piece, key, force) {\n    if (state.pieces[key]) {\n        if (force)\n            delete state.pieces[key];\n        else\n            return false;\n    }\n    callUserFunction(state.events.dropNewPiece, piece, key);\n    state.pieces[key] = piece;\n    state.lastMove = [key];\n    state.check = undefined;\n    callUserFunction(state.events.change);\n    state.movable.dests = undefined;\n    state.turnColor = util_1.opposite(state.turnColor);\n    return true;\n}\nexports.baseNewPiece = baseNewPiece;\nfunction baseUserMove(state, orig, dest) {\n    var result = baseMove(state, orig, dest);\n    if (result) {\n        state.movable.dests = undefined;\n        state.turnColor = util_1.opposite(state.turnColor);\n        state.animation.current = undefined;\n    }\n    return result;\n}\nfunction userMove(state, orig, dest) {\n    if (canMove(state, orig, dest)) {\n        var result = baseUserMove(state, orig, dest);\n        if (result) {\n            var holdTime = state.hold.stop();\n            unselect(state);\n            var metadata = {\n                premove: false,\n                ctrlKey: state.stats.ctrlKey,\n                holdTime: holdTime\n            };\n            if (result !== true)\n                metadata.captured = result;\n            callUserFunction(state.movable.events.after, orig, dest, metadata);\n            return true;\n        }\n    }\n    else if (canPremove(state, orig, dest)) {\n        setPremove(state, orig, dest, {\n            ctrlKey: state.stats.ctrlKey\n        });\n        unselect(state);\n    }\n    else if (isMovable(state, dest) || isPremovable(state, dest)) {\n        setSelected(state, dest);\n        state.hold.start();\n    }\n    else\n        unselect(state);\n    return false;\n}\nexports.userMove = userMove;\nfunction dropNewPiece(state, orig, dest, force) {\n    if (canDrop(state, orig, dest) || force) {\n        var piece = state.pieces[orig];\n        delete state.pieces[orig];\n        baseNewPiece(state, piece, dest, force);\n        callUserFunction(state.movable.events.afterNewPiece, piece.role, dest, {\n            predrop: false\n        });\n    }\n    else if (canPredrop(state, orig, dest)) {\n        setPredrop(state, state.pieces[orig].role, dest);\n    }\n    else {\n        unsetPremove(state);\n        unsetPredrop(state);\n    }\n    delete state.pieces[orig];\n    unselect(state);\n}\nexports.dropNewPiece = dropNewPiece;\nfunction selectSquare(state, key, force) {\n    if (state.selected) {\n        if (state.selected === key && !state.draggable.enabled) {\n            unselect(state);\n            state.hold.cancel();\n        }\n        else if ((state.selectable.enabled || force) && state.selected !== key) {\n            if (userMove(state, state.selected, key))\n                state.stats.dragged = false;\n        }\n        else\n            state.hold.start();\n    }\n    else if (isMovable(state, key) || isPremovable(state, key)) {\n        setSelected(state, key);\n        state.hold.start();\n    }\n    callUserFunction(state.events.select, key);\n}\nexports.selectSquare = selectSquare;\nfunction setSelected(state, key) {\n    state.selected = key;\n    if (isPremovable(state, key)) {\n        state.premovable.dests = premove_1.default(state.pieces, key, state.premovable.castle);\n    }\n    else\n        state.premovable.dests = undefined;\n}\nexports.setSelected = setSelected;\nfunction unselect(state) {\n    state.selected = undefined;\n    state.premovable.dests = undefined;\n    state.hold.cancel();\n}\nexports.unselect = unselect;\nfunction isMovable(state, orig) {\n    var piece = state.pieces[orig];\n    return piece && (state.movable.color === 'both' || (state.movable.color === piece.color &&\n        state.turnColor === piece.color));\n}\nfunction canMove(state, orig, dest) {\n    return orig !== dest && isMovable(state, orig) && (state.movable.free || (!!state.movable.dests && util_1.containsX(state.movable.dests[orig], dest)));\n}\nexports.canMove = canMove;\nfunction canDrop(state, orig, dest) {\n    var piece = state.pieces[orig];\n    return piece && dest && (orig === dest || !state.pieces[dest]) && (state.movable.color === 'both' || (state.movable.color === piece.color &&\n        state.turnColor === piece.color));\n}\nfunction isPremovable(state, orig) {\n    var piece = state.pieces[orig];\n    return piece && state.premovable.enabled &&\n        state.movable.color === piece.color &&\n        state.turnColor !== piece.color;\n}\nfunction canPremove(state, orig, dest) {\n    return orig !== dest &&\n        isPremovable(state, orig) &&\n        util_1.containsX(premove_1.default(state.pieces, orig, state.premovable.castle), dest);\n}\nfunction canPredrop(state, orig, dest) {\n    var piece = state.pieces[orig];\n    return piece && dest &&\n        (!state.pieces[dest] || state.pieces[dest].color !== state.movable.color) &&\n        state.predroppable.enabled &&\n        (piece.role !== 'pawn' || (dest[1] !== '1' && dest[1] !== '8')) &&\n        state.movable.color === piece.color &&\n        state.turnColor !== piece.color;\n}\nfunction isDraggable(state, orig) {\n    var piece = state.pieces[orig];\n    return piece && state.draggable.enabled && (state.movable.color === 'both' || (state.movable.color === piece.color && (state.turnColor === piece.color || state.premovable.enabled)));\n}\nexports.isDraggable = isDraggable;\nfunction playPremove(state) {\n    var move = state.premovable.current;\n    if (!move)\n        return false;\n    var orig = move[0], dest = move[1];\n    var success = false;\n    if (canMove(state, orig, dest)) {\n        var result = baseUserMove(state, orig, dest);\n        if (result) {\n            var metadata = { premove: true };\n            if (result !== true)\n                metadata.captured = result;\n            callUserFunction(state.movable.events.after, orig, dest, metadata);\n            success = true;\n        }\n    }\n    unsetPremove(state);\n    return success;\n}\nexports.playPremove = playPremove;\nfunction playPredrop(state, validate) {\n    var drop = state.predroppable.current, success = false;\n    if (!drop)\n        return false;\n    if (validate(drop)) {\n        var piece = {\n            role: drop.role,\n            color: state.movable.color\n        };\n        if (baseNewPiece(state, piece, drop.key)) {\n            callUserFunction(state.movable.events.afterNewPiece, drop.role, drop.key, {\n                predrop: true\n            });\n            success = true;\n        }\n    }\n    unsetPredrop(state);\n    return success;\n}\nexports.playPredrop = playPredrop;\nfunction cancelMove(state) {\n    unsetPremove(state);\n    unsetPredrop(state);\n    unselect(state);\n}\nexports.cancelMove = cancelMove;\nfunction stop(state) {\n    state.movable.color =\n        state.movable.dests =\n            state.animation.current = undefined;\n    cancelMove(state);\n}\nexports.stop = stop;\nfunction getKeyAtDomPos(pos, asWhite, bounds) {\n    var file = Math.ceil(8 * ((pos[0] - bounds.left) / bounds.width));\n    if (!asWhite)\n        file = 9 - file;\n    var rank = Math.ceil(8 - (8 * ((pos[1] - bounds.top) / bounds.height)));\n    if (!asWhite)\n        rank = 9 - rank;\n    return (file > 0 && file < 9 && rank > 0 && rank < 9) ? util_1.pos2key([file, rank]) : undefined;\n}\nexports.getKeyAtDomPos = getKeyAtDomPos;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.files = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h'];\nexports.ranks = [1, 2, 3, 4, 5, 6, 7, 8];\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"./util\");\nvar cg = require(\"./types\");\nexports.initial = 'rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR';\nvar roles = { p: 'pawn', r: 'rook', n: 'knight', b: 'bishop', q: 'queen', k: 'king' };\nvar letters = { pawn: 'p', rook: 'r', knight: 'n', bishop: 'b', queen: 'q', king: 'k' };\nfunction read(fen) {\n    if (fen === 'start')\n        fen = exports.initial;\n    var pieces = {};\n    var row = 8;\n    var col = 0;\n    for (var _i = 0, fen_1 = fen; _i < fen_1.length; _i++) {\n        var c = fen_1[_i];\n        switch (c) {\n            case ' ': return pieces;\n            case '/':\n                --row;\n                if (row === 0)\n                    return pieces;\n                col = 0;\n                break;\n            case '~':\n                pieces[util_1.pos2key([col, row])].promoted = true;\n                break;\n            default:\n                var nb = c.charCodeAt(0);\n                if (nb < 57)\n                    col += nb - 48;\n                else {\n                    ++col;\n                    var role = c.toLowerCase();\n                    pieces[util_1.pos2key([col, row])] = {\n                        role: roles[role],\n                        color: (c === role ? 'black' : 'white')\n                    };\n                }\n        }\n    }\n    return pieces;\n}\nexports.read = read;\nfunction write(pieces) {\n    var piece, letter;\n    return util_1.invRanks.map(function (y) { return cg.ranks.map(function (x) {\n        piece = pieces[util_1.pos2key([x, y])];\n        if (piece) {\n            letter = letters[piece.role];\n            return piece.color === 'white' ? letter.toUpperCase() : letter;\n        }\n        else\n            return '1';\n    }).join(''); }).join('/').replace(/1{2,}/g, function (s) { return s.length.toString(); });\n}\nexports.write = write;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar board_1 = require(\"./board\");\nvar fen_1 = require(\"./fen\");\nfunction configure(state, config) {\n    if (config.movable && config.movable.dests)\n        state.movable.dests = undefined;\n    merge(state, config);\n    if (config.fen) {\n        state.pieces = fen_1.read(config.fen);\n        state.drawable.shapes = [];\n    }\n    if (config.hasOwnProperty('check'))\n        board_1.setCheck(state, config.check || false);\n    if (config.hasOwnProperty('lastMove') && !config.lastMove)\n        state.lastMove = undefined;\n    else if (config.lastMove)\n        state.lastMove = config.lastMove;\n    if (state.selected)\n        board_1.setSelected(state, state.selected);\n    if (!state.animation.duration || state.animation.duration < 100)\n        state.animation.enabled = false;\n    if (!state.movable.rookCastle && state.movable.dests) {\n        var rank_1 = state.movable.color === 'white' ? 1 : 8;\n        var kingStartPos = 'e' + rank_1;\n        var dests_1 = state.movable.dests[kingStartPos];\n        if (!dests_1 || state.pieces[kingStartPos].role !== 'king')\n            return;\n        state.movable.dests[kingStartPos] = dests_1.filter(function (d) {\n            return !((d === 'a' + rank_1) && dests_1.indexOf('c' + rank_1) !== -1) &&\n                !((d === 'h' + rank_1) && dests_1.indexOf('g' + rank_1) !== -1);\n        });\n    }\n}\nexports.configure = configure;\n;\nfunction merge(base, extend) {\n    for (var key in extend) {\n        if (isObject(base[key]) && isObject(extend[key]))\n            merge(base[key], extend[key]);\n        else\n            base[key] = extend[key];\n    }\n}\nfunction isObject(o) {\n    return typeof o === 'object';\n}\n","\"use strict\";\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util = require(\"./util\");\nfunction anim(mutation, state) {\n    return state.animation.enabled ? animate(mutation, state) : render(mutation, state);\n}\nexports.anim = anim;\nfunction render(mutation, state) {\n    var result = mutation(state);\n    state.dom.redraw();\n    return result;\n}\nexports.render = render;\nfunction makePiece(key, piece) {\n    return {\n        key: key,\n        pos: util.key2pos(key),\n        piece: piece\n    };\n}\nfunction closer(piece, pieces) {\n    return pieces.sort(function (p1, p2) {\n        return util.distanceSq(piece.pos, p1.pos) - util.distanceSq(piece.pos, p2.pos);\n    })[0];\n}\nfunction computePlan(prevPieces, current) {\n    var anims = {}, animedOrigs = [], fadings = {}, missings = [], news = [], prePieces = {};\n    var curP, preP, i, vector;\n    for (i in prevPieces) {\n        prePieces[i] = makePiece(i, prevPieces[i]);\n    }\n    for (var _i = 0, _a = util.allKeys; _i < _a.length; _i++) {\n        var key = _a[_i];\n        curP = current.pieces[key];\n        preP = prePieces[key];\n        if (curP) {\n            if (preP) {\n                if (!util.samePiece(curP, preP.piece)) {\n                    missings.push(preP);\n                    news.push(makePiece(key, curP));\n                }\n            }\n            else\n                news.push(makePiece(key, curP));\n        }\n        else if (preP)\n            missings.push(preP);\n    }\n    news.forEach(function (newP) {\n        preP = closer(newP, missings.filter(function (p) { return util.samePiece(newP.piece, p.piece); }));\n        if (preP) {\n            vector = [preP.pos[0] - newP.pos[0], preP.pos[1] - newP.pos[1]];\n            anims[newP.key] = vector.concat(vector);\n            animedOrigs.push(preP.key);\n        }\n    });\n    missings.forEach(function (p) {\n        if (!util.containsX(animedOrigs, p.key) &&\n            !(current.items ? current.items(p.pos, p.key) : false))\n            fadings[p.key] = p.piece;\n    });\n    return {\n        anims: anims,\n        fadings: fadings\n    };\n}\nvar perf = window.performance !== undefined ? window.performance : Date;\nfunction step(state, now) {\n    var cur = state.animation.current;\n    if (cur === undefined) {\n        if (!state.dom.destroyed)\n            state.dom.redrawNow();\n        return;\n    }\n    var rest = 1 - (now - cur.start) * cur.frequency;\n    if (rest <= 0) {\n        state.animation.current = undefined;\n        state.dom.redrawNow();\n    }\n    else {\n        var ease = easing(rest);\n        for (var i in cur.plan.anims) {\n            var cfg = cur.plan.anims[i];\n            cfg[2] = cfg[0] * ease;\n            cfg[3] = cfg[1] * ease;\n        }\n        state.dom.redrawNow(true);\n        util.raf(function (now) {\n            if (now === void 0) { now = perf.now(); }\n            return step(state, now);\n        });\n    }\n}\nfunction animate(mutation, state) {\n    var prevPieces = __assign({}, state.pieces);\n    var result = mutation(state);\n    var plan = computePlan(prevPieces, state);\n    if (!isObjectEmpty(plan.anims) || !isObjectEmpty(plan.fadings)) {\n        var alreadyRunning = state.animation.current && state.animation.current.start;\n        state.animation.current = {\n            start: perf.now(),\n            frequency: 1 / state.animation.duration,\n            plan: plan\n        };\n        if (!alreadyRunning)\n            step(state, perf.now());\n    }\n    else {\n        state.dom.redraw();\n    }\n    return result;\n}\nfunction isObjectEmpty(o) {\n    for (var _ in o)\n        return false;\n    return true;\n}\nfunction easing(t) {\n    return t < 0.5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1;\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar board = require(\"./board\");\nvar util = require(\"./util\");\nvar draw_1 = require(\"./draw\");\nvar anim_1 = require(\"./anim\");\nfunction start(s, e) {\n    if (e.button !== undefined && e.button !== 0)\n        return;\n    if (e.touches && e.touches.length > 1)\n        return;\n    e.preventDefault();\n    var asWhite = s.orientation === 'white', bounds = s.dom.bounds(), position = util.eventPosition(e), orig = board.getKeyAtDomPos(position, asWhite, bounds);\n    if (!orig)\n        return;\n    var piece = s.pieces[orig];\n    var previouslySelected = s.selected;\n    if (!previouslySelected && s.drawable.enabled && (s.drawable.eraseOnClick || (!piece || piece.color !== s.turnColor)))\n        draw_1.clear(s);\n    var hadPremove = !!s.premovable.current;\n    var hadPredrop = !!s.predroppable.current;\n    s.stats.ctrlKey = e.ctrlKey;\n    if (s.selected && board.canMove(s, s.selected, orig)) {\n        anim_1.anim(function (state) { return board.selectSquare(state, orig); }, s);\n    }\n    else {\n        board.selectSquare(s, orig);\n    }\n    var stillSelected = s.selected === orig;\n    var element = pieceElementByKey(s, orig);\n    if (piece && element && stillSelected && board.isDraggable(s, orig)) {\n        var squareBounds = computeSquareBounds(orig, asWhite, bounds);\n        s.draggable.current = {\n            orig: orig,\n            origPos: util.key2pos(orig),\n            piece: piece,\n            rel: position,\n            epos: position,\n            pos: [0, 0],\n            dec: s.draggable.centerPiece ? [\n                position[0] - (squareBounds.left + squareBounds.width / 2),\n                position[1] - (squareBounds.top + squareBounds.height / 2)\n            ] : [0, 0],\n            started: s.draggable.autoDistance && s.stats.dragged,\n            element: element,\n            previouslySelected: previouslySelected,\n            originTarget: e.target\n        };\n        element.cgDragging = true;\n        element.classList.add('dragging');\n        var ghost = s.dom.elements.ghost;\n        if (ghost) {\n            ghost.className = \"ghost \" + piece.color + \" \" + piece.role;\n            util.translateAbs(ghost, util.posToTranslateAbs(bounds)(util.key2pos(orig), asWhite));\n            util.setVisible(ghost, true);\n        }\n        processDrag(s);\n    }\n    else {\n        if (hadPremove)\n            board.unsetPremove(s);\n        if (hadPredrop)\n            board.unsetPredrop(s);\n    }\n    s.dom.redraw();\n}\nexports.start = start;\nfunction dragNewPiece(s, piece, e, force) {\n    var key = 'a0';\n    s.pieces[key] = piece;\n    s.dom.redraw();\n    var position = util.eventPosition(e), asWhite = s.orientation === 'white', bounds = s.dom.bounds(), squareBounds = computeSquareBounds(key, asWhite, bounds);\n    var rel = [\n        (asWhite ? 0 : 7) * squareBounds.width + bounds.left,\n        (asWhite ? 8 : -1) * squareBounds.height + bounds.top\n    ];\n    s.draggable.current = {\n        orig: key,\n        origPos: util.key2pos(key),\n        piece: piece,\n        rel: rel,\n        epos: position,\n        pos: [position[0] - rel[0], position[1] - rel[1]],\n        dec: [-squareBounds.width / 2, -squareBounds.height / 2],\n        started: true,\n        element: function () { return pieceElementByKey(s, key); },\n        originTarget: e.target,\n        newPiece: true,\n        force: force || false\n    };\n    processDrag(s);\n}\nexports.dragNewPiece = dragNewPiece;\nfunction processDrag(s) {\n    util.raf(function () {\n        var cur = s.draggable.current;\n        if (!cur)\n            return;\n        if (s.animation.current && s.animation.current.plan.anims[cur.orig])\n            s.animation.current = undefined;\n        var origPiece = s.pieces[cur.orig];\n        if (!origPiece || !util.samePiece(origPiece, cur.piece))\n            cancel(s);\n        else {\n            if (!cur.started && util.distanceSq(cur.epos, cur.rel) >= Math.pow(s.draggable.distance, 2))\n                cur.started = true;\n            if (cur.started) {\n                if (typeof cur.element === 'function') {\n                    var found = cur.element();\n                    if (!found)\n                        return;\n                    cur.element = found;\n                    cur.element.cgDragging = true;\n                    cur.element.classList.add('dragging');\n                }\n                var asWhite = s.orientation === 'white', bounds = s.dom.bounds();\n                cur.pos = [\n                    cur.epos[0] - cur.rel[0],\n                    cur.epos[1] - cur.rel[1]\n                ];\n                var translation = util.posToTranslateAbs(bounds)(cur.origPos, asWhite);\n                translation[0] += cur.pos[0] + cur.dec[0];\n                translation[1] += cur.pos[1] + cur.dec[1];\n                util.translateAbs(cur.element, translation);\n            }\n        }\n        processDrag(s);\n    });\n}\nfunction move(s, e) {\n    if (s.draggable.current && (!e.touches || e.touches.length < 2)) {\n        s.draggable.current.epos = util.eventPosition(e);\n    }\n}\nexports.move = move;\nfunction end(s, e) {\n    var cur = s.draggable.current;\n    if (!cur)\n        return;\n    if (e.type === 'touchend' && cur && cur.originTarget !== e.target && !cur.newPiece) {\n        s.draggable.current = undefined;\n        return;\n    }\n    board.unsetPremove(s);\n    board.unsetPredrop(s);\n    var eventPos = util.eventPosition(e) || cur.epos;\n    var dest = board.getKeyAtDomPos(eventPos, s.orientation === 'white', s.dom.bounds());\n    if (dest && cur.started) {\n        if (cur.newPiece)\n            board.dropNewPiece(s, cur.orig, dest, cur.force);\n        else {\n            s.stats.ctrlKey = e.ctrlKey;\n            if (board.userMove(s, cur.orig, dest))\n                s.stats.dragged = true;\n        }\n    }\n    else if (cur.newPiece) {\n        delete s.pieces[cur.orig];\n    }\n    else if (s.draggable.deleteOnDropOff) {\n        delete s.pieces[cur.orig];\n        board.callUserFunction(s.events.change);\n    }\n    if (cur && cur.orig === cur.previouslySelected && (cur.orig === dest || !dest))\n        board.unselect(s);\n    else if (!s.selectable.enabled)\n        board.unselect(s);\n    removeDragElements(s);\n    s.draggable.current = undefined;\n    s.dom.redraw();\n}\nexports.end = end;\nfunction cancel(s) {\n    var cur = s.draggable.current;\n    if (cur) {\n        if (cur.newPiece)\n            delete s.pieces[cur.orig];\n        s.draggable.current = undefined;\n        board.unselect(s);\n        removeDragElements(s);\n        s.dom.redraw();\n    }\n}\nexports.cancel = cancel;\nfunction removeDragElements(s) {\n    var e = s.dom.elements;\n    if (e.ghost)\n        util.setVisible(e.ghost, false);\n}\nfunction computeSquareBounds(key, asWhite, bounds) {\n    var pos = util.key2pos(key);\n    if (!asWhite) {\n        pos[0] = 9 - pos[0];\n        pos[1] = 9 - pos[1];\n    }\n    return {\n        left: bounds.left + bounds.width * (pos[0] - 1) / 8,\n        top: bounds.top + bounds.height * (8 - pos[1]) / 8,\n        width: bounds.width / 8,\n        height: bounds.height / 8\n    };\n}\nfunction pieceElementByKey(s, key) {\n    var el = s.dom.elements.board.firstChild;\n    while (el) {\n        if (el.cgKey === key && el.tagName === 'PIECE')\n            return el;\n        el = el.nextSibling;\n    }\n    return undefined;\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar board_1 = require(\"./board\");\nvar util_1 = require(\"./util\");\nvar brushes = ['green', 'red', 'blue', 'yellow'];\nfunction start(state, e) {\n    if (e.touches && e.touches.length > 1)\n        return;\n    e.stopPropagation();\n    e.preventDefault();\n    board_1.cancelMove(state);\n    var position = util_1.eventPosition(e);\n    var orig = board_1.getKeyAtDomPos(position, state.orientation === 'white', state.dom.bounds());\n    if (!orig)\n        return;\n    state.drawable.current = {\n        orig: orig,\n        pos: position,\n        brush: eventBrush(e)\n    };\n    processDraw(state);\n}\nexports.start = start;\nfunction processDraw(state) {\n    util_1.raf(function () {\n        var cur = state.drawable.current;\n        if (cur) {\n            var mouseSq = board_1.getKeyAtDomPos(cur.pos, state.orientation === 'white', state.dom.bounds());\n            if (mouseSq !== cur.mouseSq) {\n                cur.mouseSq = mouseSq;\n                cur.dest = mouseSq !== cur.orig ? mouseSq : undefined;\n                state.dom.redrawNow();\n            }\n            processDraw(state);\n        }\n    });\n}\nexports.processDraw = processDraw;\nfunction move(state, e) {\n    if (state.drawable.current)\n        state.drawable.current.pos = util_1.eventPosition(e);\n}\nexports.move = move;\nfunction end(state) {\n    var cur = state.drawable.current;\n    if (cur) {\n        if (cur.mouseSq)\n            addShape(state.drawable, cur);\n        cancel(state);\n    }\n}\nexports.end = end;\nfunction cancel(state) {\n    if (state.drawable.current) {\n        state.drawable.current = undefined;\n        state.dom.redraw();\n    }\n}\nexports.cancel = cancel;\nfunction clear(state) {\n    if (state.drawable.shapes.length) {\n        state.drawable.shapes = [];\n        state.dom.redraw();\n        onChange(state.drawable);\n    }\n}\nexports.clear = clear;\nfunction eventBrush(e) {\n    var a = e.shiftKey && util_1.isRightButton(e) ? 1 : 0;\n    var b = e.altKey ? 2 : 0;\n    return brushes[a + b];\n}\nfunction not(f) {\n    return function (x) { return !f(x); };\n}\nfunction addShape(drawable, cur) {\n    var sameShape = function (s) {\n        return s.orig === cur.orig && s.dest === cur.dest;\n    };\n    var similar = drawable.shapes.filter(sameShape)[0];\n    if (similar)\n        drawable.shapes = drawable.shapes.filter(not(sameShape));\n    if (!similar || similar.brush !== cur.brush)\n        drawable.shapes.push(cur);\n    onChange(drawable);\n}\nfunction onChange(drawable) {\n    if (drawable.onChange)\n        drawable.onChange(drawable.shapes);\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"./util\");\nfunction createElement(tagName) {\n    return document.createElementNS('http://www.w3.org/2000/svg', tagName);\n}\nexports.createElement = createElement;\nvar isTrident;\nfunction renderSvg(state, root) {\n    var d = state.drawable, curD = d.current, cur = curD && curD.mouseSq ? curD : undefined, arrowDests = {};\n    d.shapes.concat(d.autoShapes).concat(cur ? [cur] : []).forEach(function (s) {\n        if (s.dest)\n            arrowDests[s.dest] = (arrowDests[s.dest] || 0) + 1;\n    });\n    var shapes = d.shapes.concat(d.autoShapes).map(function (s) {\n        return {\n            shape: s,\n            current: false,\n            hash: shapeHash(s, arrowDests, false)\n        };\n    });\n    if (cur)\n        shapes.push({\n            shape: cur,\n            current: true,\n            hash: shapeHash(cur, arrowDests, true)\n        });\n    var fullHash = shapes.map(function (sc) { return sc.hash; }).join('');\n    if (fullHash === state.drawable.prevSvgHash)\n        return;\n    state.drawable.prevSvgHash = fullHash;\n    var defsEl = root.firstChild;\n    syncDefs(d, shapes, defsEl);\n    syncShapes(state, shapes, d.brushes, arrowDests, root, defsEl);\n}\nexports.renderSvg = renderSvg;\nfunction syncDefs(d, shapes, defsEl) {\n    var brushes = {};\n    var brush;\n    shapes.forEach(function (s) {\n        if (s.shape.dest) {\n            brush = d.brushes[s.shape.brush];\n            if (s.shape.modifiers)\n                brush = makeCustomBrush(brush, s.shape.modifiers);\n            brushes[brush.key] = brush;\n        }\n    });\n    var keysInDom = {};\n    var el = defsEl.firstChild;\n    while (el) {\n        keysInDom[el.getAttribute('cgKey')] = true;\n        el = el.nextSibling;\n    }\n    for (var key in brushes) {\n        if (!keysInDom[key])\n            defsEl.appendChild(renderMarker(brushes[key]));\n    }\n}\nfunction syncShapes(state, shapes, brushes, arrowDests, root, defsEl) {\n    if (isTrident === undefined)\n        isTrident = util_1.computeIsTrident();\n    var bounds = state.dom.bounds(), hashesInDom = {}, toRemove = [];\n    shapes.forEach(function (sc) { hashesInDom[sc.hash] = false; });\n    var el = defsEl.nextSibling, elHash;\n    while (el) {\n        elHash = el.getAttribute('cgHash');\n        if (hashesInDom.hasOwnProperty(elHash))\n            hashesInDom[elHash] = true;\n        else\n            toRemove.push(el);\n        el = el.nextSibling;\n    }\n    toRemove.forEach(function (el) { return root.removeChild(el); });\n    shapes.forEach(function (sc) {\n        if (!hashesInDom[sc.hash])\n            root.appendChild(renderShape(state, sc, brushes, arrowDests, bounds));\n    });\n}\nfunction shapeHash(_a, arrowDests, current) {\n    var orig = _a.orig, dest = _a.dest, brush = _a.brush, piece = _a.piece, modifiers = _a.modifiers;\n    return [current, orig, dest, brush, dest && arrowDests[dest] > 1,\n        piece && pieceHash(piece),\n        modifiers && modifiersHash(modifiers)\n    ].filter(function (x) { return x; }).join('');\n}\nfunction pieceHash(piece) {\n    return [piece.color, piece.role, piece.scale].filter(function (x) { return x; }).join('');\n}\nfunction modifiersHash(m) {\n    return '' + (m.lineWidth || '');\n}\nfunction renderShape(state, _a, brushes, arrowDests, bounds) {\n    var shape = _a.shape, current = _a.current, hash = _a.hash;\n    var el;\n    if (shape.piece)\n        el = renderPiece(state.drawable.pieces.baseUrl, orient(util_1.key2pos(shape.orig), state.orientation), shape.piece, bounds);\n    else {\n        var orig = orient(util_1.key2pos(shape.orig), state.orientation);\n        if (shape.orig && shape.dest) {\n            var brush = brushes[shape.brush];\n            if (shape.modifiers)\n                brush = makeCustomBrush(brush, shape.modifiers);\n            el = renderArrow(brush, orig, orient(util_1.key2pos(shape.dest), state.orientation), current, arrowDests[shape.dest] > 1, bounds);\n        }\n        else\n            el = renderCircle(brushes[shape.brush], orig, current, bounds);\n    }\n    el.setAttribute('cgHash', hash);\n    return el;\n}\nfunction renderCircle(brush, pos, current, bounds) {\n    var o = pos2px(pos, bounds), widths = circleWidth(bounds), radius = (bounds.width + bounds.height) / 32;\n    return setAttributes(createElement('circle'), {\n        stroke: brush.color,\n        'stroke-width': widths[current ? 0 : 1],\n        fill: 'none',\n        opacity: opacity(brush, current),\n        cx: o[0],\n        cy: o[1],\n        r: radius - widths[1] / 2\n    });\n}\nfunction renderArrow(brush, orig, dest, current, shorten, bounds) {\n    var m = arrowMargin(bounds, shorten && !current), a = pos2px(orig, bounds), b = pos2px(dest, bounds), dx = b[0] - a[0], dy = b[1] - a[1], angle = Math.atan2(dy, dx), xo = Math.cos(angle) * m, yo = Math.sin(angle) * m;\n    return setAttributes(createElement('line'), {\n        stroke: brush.color,\n        'stroke-width': lineWidth(brush, current, bounds),\n        'stroke-linecap': 'round',\n        'marker-end': isTrident ? undefined : 'url(#arrowhead-' + brush.key + ')',\n        opacity: opacity(brush, current),\n        x1: a[0],\n        y1: a[1],\n        x2: b[0] - xo,\n        y2: b[1] - yo\n    });\n}\nfunction renderPiece(baseUrl, pos, piece, bounds) {\n    var o = pos2px(pos, bounds), size = bounds.width / 8 * (piece.scale || 1), name = piece.color[0] + (piece.role === 'knight' ? 'n' : piece.role[0]).toUpperCase();\n    return setAttributes(createElement('image'), {\n        className: piece.role + \" \" + piece.color,\n        x: o[0] - size / 2,\n        y: o[1] - size / 2,\n        width: size,\n        height: size,\n        href: baseUrl + name + '.svg'\n    });\n}\nfunction renderMarker(brush) {\n    var marker = setAttributes(createElement('marker'), {\n        id: 'arrowhead-' + brush.key,\n        orient: 'auto',\n        markerWidth: 4,\n        markerHeight: 8,\n        refX: 2.05,\n        refY: 2.01\n    });\n    marker.appendChild(setAttributes(createElement('path'), {\n        d: 'M0,0 V4 L3,2 Z',\n        fill: brush.color\n    }));\n    marker.setAttribute('cgKey', brush.key);\n    return marker;\n}\nfunction setAttributes(el, attrs) {\n    for (var key in attrs)\n        el.setAttribute(key, attrs[key]);\n    return el;\n}\nfunction orient(pos, color) {\n    return color === 'white' ? pos : [9 - pos[0], 9 - pos[1]];\n}\nfunction makeCustomBrush(base, modifiers) {\n    var brush = {\n        color: base.color,\n        opacity: Math.round(base.opacity * 10) / 10,\n        lineWidth: Math.round(modifiers.lineWidth || base.lineWidth)\n    };\n    brush.key = [base.key, modifiers.lineWidth].filter(function (x) { return x; }).join('');\n    return brush;\n}\nfunction circleWidth(bounds) {\n    var base = bounds.width / 512;\n    return [3 * base, 4 * base];\n}\nfunction lineWidth(brush, current, bounds) {\n    return (brush.lineWidth || 10) * (current ? 0.85 : 1) / 512 * bounds.width;\n}\nfunction opacity(brush, current) {\n    return (brush.opacity || 1) * (current ? 0.9 : 1);\n}\nfunction arrowMargin(bounds, shorten) {\n    return isTrident ? 0 : ((shorten ? 20 : 10) / 512 * bounds.width);\n}\nfunction pos2px(pos, bounds) {\n    return [(pos[0] - 0.5) * bounds.width / 8, (8.5 - pos[1]) * bounds.height / 8];\n}\n","module.exports = { prefix: 'fas', iconName: 'book', icon: [448, 512, [], \"f02d\", \"M448 360V24c0-13.3-10.7-24-24-24H96C43 0 0 43 0 96v320c0 53 43 96 96 96h328c13.3 0 24-10.7 24-24v-16c0-7.5-3.5-14.3-8.9-18.7-4.2-15.4-4.2-59.3 0-74.7 5.4-4.3 8.9-11.1 8.9-18.6zM128 134c0-3.3 2.7-6 6-6h212c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H134c-3.3 0-6-2.7-6-6v-20zm0 64c0-3.3 2.7-6 6-6h212c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H134c-3.3 0-6-2.7-6-6v-20zm253.4 250H96c-17.7 0-32-14.3-32-32 0-17.6 14.4-32 32-32h285.4c-1.9 17.1-1.9 46.9 0 64z\"] };","module.exports = { prefix: 'fas', iconName: 'cogs', icon: [640, 512, [], \"f085\", \"M512.1 191l-8.2 14.3c-3 5.3-9.4 7.5-15.1 5.4-11.8-4.4-22.6-10.7-32.1-18.6-4.6-3.8-5.8-10.5-2.8-15.7l8.2-14.3c-6.9-8-12.3-17.3-15.9-27.4h-16.5c-6 0-11.2-4.3-12.2-10.3-2-12-2.1-24.6 0-37.1 1-6 6.2-10.4 12.2-10.4h16.5c3.6-10.1 9-19.4 15.9-27.4l-8.2-14.3c-3-5.2-1.9-11.9 2.8-15.7 9.5-7.9 20.4-14.2 32.1-18.6 5.7-2.1 12.1.1 15.1 5.4l8.2 14.3c10.5-1.9 21.2-1.9 31.7 0L552 6.3c3-5.3 9.4-7.5 15.1-5.4 11.8 4.4 22.6 10.7 32.1 18.6 4.6 3.8 5.8 10.5 2.8 15.7l-8.2 14.3c6.9 8 12.3 17.3 15.9 27.4h16.5c6 0 11.2 4.3 12.2 10.3 2 12 2.1 24.6 0 37.1-1 6-6.2 10.4-12.2 10.4h-16.5c-3.6 10.1-9 19.4-15.9 27.4l8.2 14.3c3 5.2 1.9 11.9-2.8 15.7-9.5 7.9-20.4 14.2-32.1 18.6-5.7 2.1-12.1-.1-15.1-5.4l-8.2-14.3c-10.4 1.9-21.2 1.9-31.7 0zm-10.5-58.8c38.5 29.6 82.4-14.3 52.8-52.8-38.5-29.7-82.4 14.3-52.8 52.8zM386.3 286.1l33.7 16.8c10.1 5.8 14.5 18.1 10.5 29.1-8.9 24.2-26.4 46.4-42.6 65.8-7.4 8.9-20.2 11.1-30.3 5.3l-29.1-16.8c-16 13.7-34.6 24.6-54.9 31.7v33.6c0 11.6-8.3 21.6-19.7 23.6-24.6 4.2-50.4 4.4-75.9 0-11.5-2-20-11.9-20-23.6V418c-20.3-7.2-38.9-18-54.9-31.7L74 403c-10 5.8-22.9 3.6-30.3-5.3-16.2-19.4-33.3-41.6-42.2-65.7-4-10.9.4-23.2 10.5-29.1l33.3-16.8c-3.9-20.9-3.9-42.4 0-63.4L12 205.8c-10.1-5.8-14.6-18.1-10.5-29 8.9-24.2 26-46.4 42.2-65.8 7.4-8.9 20.2-11.1 30.3-5.3l29.1 16.8c16-13.7 34.6-24.6 54.9-31.7V57.1c0-11.5 8.2-21.5 19.6-23.5 24.6-4.2 50.5-4.4 76-.1 11.5 2 20 11.9 20 23.6v33.6c20.3 7.2 38.9 18 54.9 31.7l29.1-16.8c10-5.8 22.9-3.6 30.3 5.3 16.2 19.4 33.2 41.6 42.1 65.8 4 10.9.1 23.2-10 29.1l-33.7 16.8c3.9 21 3.9 42.5 0 63.5zm-117.6 21.1c59.2-77-28.7-164.9-105.7-105.7-59.2 77 28.7 164.9 105.7 105.7zm243.4 182.7l-8.2 14.3c-3 5.3-9.4 7.5-15.1 5.4-11.8-4.4-22.6-10.7-32.1-18.6-4.6-3.8-5.8-10.5-2.8-15.7l8.2-14.3c-6.9-8-12.3-17.3-15.9-27.4h-16.5c-6 0-11.2-4.3-12.2-10.3-2-12-2.1-24.6 0-37.1 1-6 6.2-10.4 12.2-10.4h16.5c3.6-10.1 9-19.4 15.9-27.4l-8.2-14.3c-3-5.2-1.9-11.9 2.8-15.7 9.5-7.9 20.4-14.2 32.1-18.6 5.7-2.1 12.1.1 15.1 5.4l8.2 14.3c10.5-1.9 21.2-1.9 31.7 0l8.2-14.3c3-5.3 9.4-7.5 15.1-5.4 11.8 4.4 22.6 10.7 32.1 18.6 4.6 3.8 5.8 10.5 2.8 15.7l-8.2 14.3c6.9 8 12.3 17.3 15.9 27.4h16.5c6 0 11.2 4.3 12.2 10.3 2 12 2.1 24.6 0 37.1-1 6-6.2 10.4-12.2 10.4h-16.5c-3.6 10.1-9 19.4-15.9 27.4l8.2 14.3c3 5.2 1.9 11.9-2.8 15.7-9.5 7.9-20.4 14.2-32.1 18.6-5.7 2.1-12.1-.1-15.1-5.4l-8.2-14.3c-10.4 1.9-21.2 1.9-31.7 0zM501.6 431c38.5 29.6 82.4-14.3 52.8-52.8-38.5-29.6-82.4 14.3-52.8 52.8z\"] };","module.exports = { prefix: 'fas', iconName: 'info-circle', icon: [512, 512, [], \"f05a\", \"M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z\"] };","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar api_1 = require(\"./api\");\nvar config_1 = require(\"./config\");\nvar state_1 = require(\"./state\");\nvar wrap_1 = require(\"./wrap\");\nvar events = require(\"./events\");\nvar render_1 = require(\"./render\");\nvar svg = require(\"./svg\");\nvar util = require(\"./util\");\nfunction Chessground(element, config) {\n    var state = state_1.defaults();\n    config_1.configure(state, config || {});\n    function redrawAll() {\n        var prevUnbind = state.dom && state.dom.unbind;\n        element.classList.add('cg-board-wrap');\n        var bounds = util.memo(function () { return element.getBoundingClientRect(); });\n        var relative = state.viewOnly && !state.drawable.visible;\n        var elements = wrap_1.default(element, state, relative ? undefined : bounds());\n        var redrawNow = function (skipSvg) {\n            render_1.default(state);\n            if (!skipSvg && elements.svg)\n                svg.renderSvg(state, elements.svg);\n        };\n        state.dom = {\n            elements: elements,\n            bounds: bounds,\n            redraw: debounceRedraw(redrawNow),\n            redrawNow: redrawNow,\n            unbind: prevUnbind,\n            relative: relative\n        };\n        state.drawable.prevSvgHash = '';\n        redrawNow(false);\n        events.bindBoard(state);\n        if (!prevUnbind)\n            state.dom.unbind = events.bindDocument(state, redrawAll);\n    }\n    redrawAll();\n    var api = api_1.start(state, redrawAll);\n    return api;\n}\nexports.Chessground = Chessground;\n;\nfunction debounceRedraw(redrawNow) {\n    var redrawing = false;\n    return function () {\n        if (redrawing)\n            return;\n        redrawing = true;\n        util.raf(function () {\n            redrawNow();\n            redrawing = false;\n        });\n    };\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar board = require(\"./board\");\nvar fen_1 = require(\"./fen\");\nvar config_1 = require(\"./config\");\nvar anim_1 = require(\"./anim\");\nvar drag_1 = require(\"./drag\");\nvar explosion_1 = require(\"./explosion\");\nfunction start(state, redrawAll) {\n    function toggleOrientation() {\n        board.toggleOrientation(state);\n        redrawAll();\n    }\n    ;\n    return {\n        set: function (config) {\n            if (config.orientation && config.orientation !== state.orientation)\n                toggleOrientation();\n            (config.fen ? anim_1.anim : anim_1.render)(function (state) { return config_1.configure(state, config); }, state);\n        },\n        state: state,\n        getFen: function () { return fen_1.write(state.pieces); },\n        toggleOrientation: toggleOrientation,\n        setPieces: function (pieces) {\n            anim_1.anim(function (state) { return board.setPieces(state, pieces); }, state);\n        },\n        selectSquare: function (key, force) {\n            if (key)\n                anim_1.anim(function (state) { return board.selectSquare(state, key, force); }, state);\n            else if (state.selected) {\n                board.unselect(state);\n                state.dom.redraw();\n            }\n        },\n        move: function (orig, dest) {\n            anim_1.anim(function (state) { return board.baseMove(state, orig, dest); }, state);\n        },\n        newPiece: function (piece, key) {\n            anim_1.anim(function (state) { return board.baseNewPiece(state, piece, key); }, state);\n        },\n        playPremove: function () {\n            if (state.premovable.current) {\n                if (anim_1.anim(board.playPremove, state))\n                    return true;\n                state.dom.redraw();\n            }\n            return false;\n        },\n        playPredrop: function (validate) {\n            if (state.predroppable.current) {\n                var result = board.playPredrop(state, validate);\n                state.dom.redraw();\n                return result;\n            }\n            return false;\n        },\n        cancelPremove: function () {\n            anim_1.render(board.unsetPremove, state);\n        },\n        cancelPredrop: function () {\n            anim_1.render(board.unsetPredrop, state);\n        },\n        cancelMove: function () {\n            anim_1.render(function (state) { board.cancelMove(state); drag_1.cancel(state); }, state);\n        },\n        stop: function () {\n            anim_1.render(function (state) { board.stop(state); drag_1.cancel(state); }, state);\n        },\n        explode: function (keys) {\n            explosion_1.default(state, keys);\n        },\n        setAutoShapes: function (shapes) {\n            anim_1.render(function (state) { return state.drawable.autoShapes = shapes; }, state);\n        },\n        setShapes: function (shapes) {\n            anim_1.render(function (state) { return state.drawable.shapes = shapes; }, state);\n        },\n        getKeyAtDomPos: function (pos) {\n            return board.getKeyAtDomPos(pos, state.orientation === 'white', state.dom.bounds());\n        },\n        redrawAll: redrawAll,\n        dragNewPiece: function (piece, event, force) {\n            drag_1.dragNewPiece(state, piece, event, force);\n        },\n        destroy: function () {\n            board.stop(state);\n            state.dom.unbind && state.dom.unbind();\n            state.dom.destroyed = true;\n        }\n    };\n}\nexports.start = start;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util = require(\"./util\");\nfunction diff(a, b) {\n    return Math.abs(a - b);\n}\nfunction pawn(color) {\n    return function (x1, y1, x2, y2) { return diff(x1, x2) < 2 && (color === 'white' ? (y2 === y1 + 1 || (y1 <= 2 && y2 === (y1 + 2) && x1 === x2)) : (y2 === y1 - 1 || (y1 >= 7 && y2 === (y1 - 2) && x1 === x2))); };\n}\nvar knight = function (x1, y1, x2, y2) {\n    var xd = diff(x1, x2);\n    var yd = diff(y1, y2);\n    return (xd === 1 && yd === 2) || (xd === 2 && yd === 1);\n};\nvar bishop = function (x1, y1, x2, y2) {\n    return diff(x1, x2) === diff(y1, y2);\n};\nvar rook = function (x1, y1, x2, y2) {\n    return x1 === x2 || y1 === y2;\n};\nvar queen = function (x1, y1, x2, y2) {\n    return bishop(x1, y1, x2, y2) || rook(x1, y1, x2, y2);\n};\nfunction king(color, rookFiles, canCastle) {\n    return function (x1, y1, x2, y2) { return (diff(x1, x2) < 2 && diff(y1, y2) < 2) || (canCastle && y1 === y2 && y1 === (color === 'white' ? 1 : 8) && ((x1 === 5 && (x2 === 3 || x2 === 7)) || util.containsX(rookFiles, x2))); };\n}\nfunction rookFilesOf(pieces, color) {\n    var piece;\n    return Object.keys(pieces).filter(function (key) {\n        piece = pieces[key];\n        return piece && piece.color === color && piece.role === 'rook';\n    }).map(function (key) { return util.key2pos(key)[0]; });\n}\nfunction premove(pieces, key, canCastle) {\n    var piece = pieces[key], pos = util.key2pos(key);\n    var mobility;\n    switch (piece.role) {\n        case 'pawn':\n            mobility = pawn(piece.color);\n            break;\n        case 'knight':\n            mobility = knight;\n            break;\n        case 'bishop':\n            mobility = bishop;\n            break;\n        case 'rook':\n            mobility = rook;\n            break;\n        case 'queen':\n            mobility = queen;\n            break;\n        case 'king':\n            mobility = king(piece.color, rookFilesOf(pieces, piece.color), canCastle);\n            break;\n    }\n    return util.allKeys.map(util.key2pos).filter(function (pos2) {\n        return (pos[0] !== pos2[0] || pos[1] !== pos2[1]) && mobility(pos[0], pos[1], pos2[0], pos2[1]);\n    }).map(util.pos2key);\n}\nexports.default = premove;\n;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction explosion(state, keys) {\n    state.exploding = {\n        stage: 1,\n        keys: keys\n    };\n    state.dom.redraw();\n    setTimeout(function () {\n        setStage(state, 2);\n        setTimeout(function () { return setStage(state, undefined); }, 120);\n    }, 120);\n}\nexports.default = explosion;\nfunction setStage(state, stage) {\n    if (state.exploding) {\n        if (stage)\n            state.exploding.stage = stage;\n        else\n            state.exploding = undefined;\n        state.dom.redraw();\n    }\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar fen = require(\"./fen\");\nvar util_1 = require(\"./util\");\nfunction defaults() {\n    return {\n        pieces: fen.read(fen.initial),\n        orientation: 'white',\n        turnColor: 'white',\n        coordinates: true,\n        autoCastle: true,\n        viewOnly: false,\n        disableContextMenu: false,\n        resizable: true,\n        addPieceZIndex: false,\n        pieceKey: false,\n        highlight: {\n            lastMove: true,\n            check: true\n        },\n        animation: {\n            enabled: true,\n            duration: 200\n        },\n        movable: {\n            free: true,\n            color: 'both',\n            showDests: true,\n            events: {},\n            rookCastle: true\n        },\n        premovable: {\n            enabled: true,\n            showDests: true,\n            castle: true,\n            events: {}\n        },\n        predroppable: {\n            enabled: false,\n            events: {}\n        },\n        draggable: {\n            enabled: true,\n            distance: 3,\n            autoDistance: true,\n            centerPiece: true,\n            showGhost: true,\n            deleteOnDropOff: false\n        },\n        selectable: {\n            enabled: true\n        },\n        stats: {\n            dragged: !('ontouchstart' in window)\n        },\n        events: {},\n        drawable: {\n            enabled: true,\n            visible: true,\n            eraseOnClick: true,\n            shapes: [],\n            autoShapes: [],\n            brushes: {\n                green: { key: 'g', color: '#15781B', opacity: 1, lineWidth: 10 },\n                red: { key: 'r', color: '#882020', opacity: 1, lineWidth: 10 },\n                blue: { key: 'b', color: '#003088', opacity: 1, lineWidth: 10 },\n                yellow: { key: 'y', color: '#e68f00', opacity: 1, lineWidth: 10 },\n                paleBlue: { key: 'pb', color: '#003088', opacity: 0.4, lineWidth: 15 },\n                paleGreen: { key: 'pg', color: '#15781B', opacity: 0.4, lineWidth: 15 },\n                paleRed: { key: 'pr', color: '#882020', opacity: 0.4, lineWidth: 15 },\n                paleGrey: { key: 'pgr', color: '#4a4a4a', opacity: 0.35, lineWidth: 15 }\n            },\n            pieces: {\n                baseUrl: 'https://lichess1.org/assets/piece/cburnett/'\n            },\n            prevSvgHash: ''\n        },\n        hold: util_1.timer()\n    };\n}\nexports.defaults = defaults;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"./util\");\nvar types_1 = require(\"./types\");\nvar svg_1 = require(\"./svg\");\nfunction wrap(element, s, bounds) {\n    element.innerHTML = '';\n    element.classList.add('cg-board-wrap');\n    util_1.colors.forEach(function (c) {\n        element.classList.toggle('orientation-' + c, s.orientation === c);\n    });\n    element.classList.toggle('manipulable', !s.viewOnly);\n    var board = util_1.createEl('div', 'cg-board');\n    element.appendChild(board);\n    var svg;\n    if (s.drawable.visible && bounds) {\n        svg = svg_1.createElement('svg');\n        svg.appendChild(svg_1.createElement('defs'));\n        element.appendChild(svg);\n    }\n    if (s.coordinates) {\n        var orientClass = s.orientation === 'black' ? ' black' : '';\n        element.appendChild(renderCoords(types_1.ranks, 'ranks' + orientClass));\n        element.appendChild(renderCoords(types_1.files, 'files' + orientClass));\n    }\n    var ghost;\n    if (bounds && s.draggable.showGhost) {\n        ghost = util_1.createEl('piece', 'ghost');\n        util_1.setVisible(ghost, false);\n        element.appendChild(ghost);\n    }\n    return {\n        board: board,\n        ghost: ghost,\n        svg: svg\n    };\n}\nexports.default = wrap;\nfunction renderCoords(elems, className) {\n    var el = util_1.createEl('coords', className);\n    var f;\n    for (var i in elems) {\n        f = util_1.createEl('coord');\n        f.textContent = elems[i];\n        el.appendChild(f);\n    }\n    return el;\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar drag = require(\"./drag\");\nvar draw = require(\"./draw\");\nvar util_1 = require(\"./util\");\nfunction bindBoard(s) {\n    if (s.viewOnly)\n        return;\n    var boardEl = s.dom.elements.board, onStart = startDragOrDraw(s);\n    boardEl.addEventListener('touchstart', onStart);\n    boardEl.addEventListener('mousedown', onStart);\n    if (s.disableContextMenu || s.drawable.enabled) {\n        boardEl.addEventListener('contextmenu', function (e) { return e.preventDefault(); });\n    }\n}\nexports.bindBoard = bindBoard;\nfunction bindDocument(s, redrawAll) {\n    var unbinds = [];\n    if (!s.dom.relative && s.resizable) {\n        var onResize = function () {\n            s.dom.bounds.clear();\n            util_1.raf(redrawAll);\n        };\n        unbinds.push(unbindable(document.body, 'chessground.resize', onResize));\n    }\n    if (!s.viewOnly) {\n        var onmove_1 = dragOrDraw(s, drag.move, draw.move);\n        var onend_1 = dragOrDraw(s, drag.end, draw.end);\n        ['touchmove', 'mousemove'].forEach(function (ev) { return unbinds.push(unbindable(document, ev, onmove_1)); });\n        ['touchend', 'mouseup'].forEach(function (ev) { return unbinds.push(unbindable(document, ev, onend_1)); });\n        var onScroll = function () { return s.dom.bounds.clear(); };\n        unbinds.push(unbindable(window, 'scroll', onScroll, { passive: true }));\n        unbinds.push(unbindable(window, 'resize', onScroll, { passive: true }));\n    }\n    return function () { return unbinds.forEach(function (f) { return f(); }); };\n}\nexports.bindDocument = bindDocument;\nfunction unbindable(el, eventName, callback, options) {\n    el.addEventListener(eventName, callback, options);\n    return function () { return el.removeEventListener(eventName, callback); };\n}\nfunction startDragOrDraw(s) {\n    return function (e) {\n        if (s.draggable.current)\n            drag.cancel(s);\n        else if (s.drawable.current)\n            draw.cancel(s);\n        else if (e.shiftKey || util_1.isRightButton(e)) {\n            if (s.drawable.enabled)\n                draw.start(s, e);\n        }\n        else if (!s.viewOnly)\n            drag.start(s, e);\n    };\n}\nfunction dragOrDraw(s, withDrag, withDraw) {\n    return function (e) {\n        if (e.shiftKey || util_1.isRightButton(e)) {\n            if (s.drawable.enabled)\n                withDraw(s, e);\n        }\n        else if (!s.viewOnly)\n            withDrag(s, e);\n    };\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"./util\");\nvar util = require(\"./util\");\nfunction render(s) {\n    var asWhite = s.orientation === 'white', posToTranslate = s.dom.relative ? util.posToTranslateRel : util.posToTranslateAbs(s.dom.bounds()), translate = s.dom.relative ? util.translateRel : util.translateAbs, boardEl = s.dom.elements.board, pieces = s.pieces, curAnim = s.animation.current, anims = curAnim ? curAnim.plan.anims : {}, fadings = curAnim ? curAnim.plan.fadings : {}, curDrag = s.draggable.current, squares = computeSquareClasses(s), samePieces = {}, sameSquares = {}, movedPieces = {}, movedSquares = {}, piecesKeys = Object.keys(pieces);\n    var k, p, el, pieceAtKey, elPieceName, anim, fading, pMvdset, pMvd, sMvdset, sMvd;\n    el = boardEl.firstChild;\n    while (el) {\n        k = el.cgKey;\n        if (isPieceNode(el)) {\n            pieceAtKey = pieces[k];\n            anim = anims[k];\n            fading = fadings[k];\n            elPieceName = el.cgPiece;\n            if (el.cgDragging && (!curDrag || curDrag.orig !== k)) {\n                el.classList.remove('dragging');\n                translate(el, posToTranslate(util_1.key2pos(k), asWhite));\n                el.cgDragging = false;\n            }\n            if (!fading && el.cgFading) {\n                el.cgFading = false;\n                el.classList.remove('fading');\n            }\n            if (pieceAtKey) {\n                if (anim && el.cgAnimating && elPieceName === pieceNameOf(pieceAtKey)) {\n                    var pos = util_1.key2pos(k);\n                    pos[0] += anim[2];\n                    pos[1] += anim[3];\n                    el.classList.add('anim');\n                    translate(el, posToTranslate(pos, asWhite));\n                }\n                else if (el.cgAnimating) {\n                    el.cgAnimating = false;\n                    el.classList.remove('anim');\n                    translate(el, posToTranslate(util_1.key2pos(k), asWhite));\n                    if (s.addPieceZIndex)\n                        el.style.zIndex = posZIndex(util_1.key2pos(k), asWhite);\n                }\n                if (elPieceName === pieceNameOf(pieceAtKey) && (!fading || !el.cgFading)) {\n                    samePieces[k] = true;\n                }\n                else {\n                    if (fading && elPieceName === pieceNameOf(fading)) {\n                        el.classList.add('fading');\n                        el.cgFading = true;\n                    }\n                    else {\n                        if (movedPieces[elPieceName])\n                            movedPieces[elPieceName].push(el);\n                        else\n                            movedPieces[elPieceName] = [el];\n                    }\n                }\n            }\n            else {\n                if (movedPieces[elPieceName])\n                    movedPieces[elPieceName].push(el);\n                else\n                    movedPieces[elPieceName] = [el];\n            }\n        }\n        else if (isSquareNode(el)) {\n            var cn = el.className;\n            if (squares[k] === cn)\n                sameSquares[k] = true;\n            else if (movedSquares[cn])\n                movedSquares[cn].push(el);\n            else\n                movedSquares[cn] = [el];\n        }\n        el = el.nextSibling;\n    }\n    for (var sk in squares) {\n        if (!sameSquares[sk]) {\n            sMvdset = movedSquares[squares[sk]];\n            sMvd = sMvdset && sMvdset.pop();\n            var translation = posToTranslate(util_1.key2pos(sk), asWhite);\n            if (sMvd) {\n                sMvd.cgKey = sk;\n                translate(sMvd, translation);\n            }\n            else {\n                var squareNode = util_1.createEl('square', squares[sk]);\n                squareNode.cgKey = sk;\n                translate(squareNode, translation);\n                boardEl.insertBefore(squareNode, boardEl.firstChild);\n            }\n        }\n    }\n    for (var j in piecesKeys) {\n        k = piecesKeys[j];\n        p = pieces[k];\n        anim = anims[k];\n        if (!samePieces[k]) {\n            pMvdset = movedPieces[pieceNameOf(p)];\n            pMvd = pMvdset && pMvdset.pop();\n            if (pMvd) {\n                pMvd.cgKey = k;\n                if (pMvd.cgFading) {\n                    pMvd.classList.remove('fading');\n                    pMvd.cgFading = false;\n                }\n                var pos = util_1.key2pos(k);\n                if (s.addPieceZIndex)\n                    pMvd.style.zIndex = posZIndex(pos, asWhite);\n                if (anim) {\n                    pMvd.cgAnimating = true;\n                    pMvd.classList.add('anim');\n                    pos[0] += anim[2];\n                    pos[1] += anim[3];\n                }\n                translate(pMvd, posToTranslate(pos, asWhite));\n            }\n            else {\n                var pieceName = pieceNameOf(p), pieceNode = util_1.createEl('piece', pieceName), pos = util_1.key2pos(k);\n                pieceNode.cgPiece = pieceName;\n                pieceNode.cgKey = k;\n                if (anim) {\n                    pieceNode.cgAnimating = true;\n                    pos[0] += anim[2];\n                    pos[1] += anim[3];\n                }\n                translate(pieceNode, posToTranslate(pos, asWhite));\n                if (s.addPieceZIndex)\n                    pieceNode.style.zIndex = posZIndex(pos, asWhite);\n                boardEl.appendChild(pieceNode);\n            }\n        }\n    }\n    for (var i in movedPieces)\n        removeNodes(s, movedPieces[i]);\n    for (var i in movedSquares)\n        removeNodes(s, movedSquares[i]);\n}\nexports.default = render;\nfunction isPieceNode(el) {\n    return el.tagName === 'PIECE';\n}\nfunction isSquareNode(el) {\n    return el.tagName === 'SQUARE';\n}\nfunction removeNodes(s, nodes) {\n    for (var i in nodes)\n        s.dom.elements.board.removeChild(nodes[i]);\n}\nfunction posZIndex(pos, asWhite) {\n    var z = 2 + (pos[1] - 1) * 8 + (8 - pos[0]);\n    if (asWhite)\n        z = 67 - z;\n    return z + '';\n}\nfunction pieceNameOf(piece) {\n    return piece.color + \" \" + piece.role;\n}\nfunction computeSquareClasses(s) {\n    var squares = {};\n    var i, k;\n    if (s.lastMove && s.highlight.lastMove)\n        for (i in s.lastMove) {\n            addSquare(squares, s.lastMove[i], 'last-move');\n        }\n    if (s.check && s.highlight.check)\n        addSquare(squares, s.check, 'check');\n    if (s.selected) {\n        addSquare(squares, s.selected, 'selected');\n        if (s.movable.showDests) {\n            var dests = s.movable.dests && s.movable.dests[s.selected];\n            if (dests)\n                for (i in dests) {\n                    k = dests[i];\n                    addSquare(squares, k, 'move-dest' + (s.pieces[k] ? ' oc' : ''));\n                }\n            var pDests = s.premovable.dests;\n            if (pDests)\n                for (i in pDests) {\n                    k = pDests[i];\n                    addSquare(squares, k, 'premove-dest' + (s.pieces[k] ? ' oc' : ''));\n                }\n        }\n    }\n    var premove = s.premovable.current;\n    if (premove)\n        for (i in premove)\n            addSquare(squares, premove[i], 'current-premove');\n    else if (s.predroppable.current)\n        addSquare(squares, s.predroppable.current.key, 'current-premove');\n    var o = s.exploding;\n    if (o)\n        for (i in o.keys)\n            addSquare(squares, o.keys[i], 'exploding' + o.stage);\n    return squares;\n}\nfunction addSquare(squares, key, klass) {\n    if (squares[key])\n        squares[key] += ' ' + klass;\n    else\n        squares[key] = klass;\n}\n","var debounce = require('./debounce'),\n    isObject = require('./isObject');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/**\n * Creates a throttled function that only invokes `func` at most once per\n * every `wait` milliseconds. The throttled function comes with a `cancel`\n * method to cancel delayed `func` invocations and a `flush` method to\n * immediately invoke them. Provide `options` to indicate whether `func`\n * should be invoked on the leading and/or trailing edge of the `wait`\n * timeout. The `func` is invoked with the last arguments provided to the\n * throttled function. Subsequent calls to the throttled function return the\n * result of the last `func` invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the throttled function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.throttle` and `_.debounce`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to throttle.\n * @param {number} [wait=0] The number of milliseconds to throttle invocations to.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=true]\n *  Specify invoking on the leading edge of the timeout.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new throttled function.\n * @example\n *\n * // Avoid excessively updating the position while scrolling.\n * jQuery(window).on('scroll', _.throttle(updatePosition, 100));\n *\n * // Invoke `renewToken` when the click event is fired, but not more than once every 5 minutes.\n * var throttled = _.throttle(renewToken, 300000, { 'trailing': false });\n * jQuery(element).on('click', throttled);\n *\n * // Cancel the trailing throttled invocation.\n * jQuery(window).on('popstate', throttled.cancel);\n */\nfunction throttle(func, wait, options) {\n  var leading = true,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  if (isObject(options)) {\n    leading = 'leading' in options ? !!options.leading : leading;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n  return debounce(func, wait, {\n    'leading': leading,\n    'maxWait': wait,\n    'trailing': trailing\n  });\n}\n\nmodule.exports = throttle;\n","import { useRef, useState, useEffect, useMemo } from 'react';\n\nfunction useResizeObserver(opts) {\n  if (opts === void 0) {\n    opts = {};\n  }\n\n  // `defaultRef` Has to be non-conditionally declared here whether or not it'll\n  // be used as that's how hooks work.\n  // @see https://reactjs.org/docs/hooks-rules.html#explanation\n  var defaultRef = useRef(null); // Saving the callback as a ref. With this, I don't need to put onResize in the\n  // effect dep array, and just passing in an anonymous function without memoising\n  // will not reinstantiate the hook's ResizeObserver\n\n  var onResize = opts.onResize;\n  var onResizeRef = useRef(undefined);\n  onResizeRef.current = onResize; // Using a single instance throughought the hook's lifetime\n\n  var resizeObserverRef = useRef();\n  var ref = opts.ref || defaultRef;\n\n  var _useState = useState({\n    width: undefined,\n    height: undefined\n  }),\n      size = _useState[0],\n      setSize = _useState[1]; // Using a ref to track the previous width / height to avoid unnecessary renders\n\n\n  var previous = useRef({\n    width: undefined,\n    height: undefined\n  });\n  useEffect(function () {\n    if (resizeObserverRef.current) {\n      return;\n    }\n\n    resizeObserverRef.current = new ResizeObserver(function (entries) {\n      if (!Array.isArray(entries)) {\n        return;\n      } // Since we only observe the one element, we don't need to loop over the\n      // array\n\n\n      if (!entries.length) {\n        return;\n      }\n\n      var entry = entries[0]; // `Math.round` is in line with how CSS resolves sub-pixel values\n\n      var newWidth = Math.round(entry.contentRect.width);\n      var newHeight = Math.round(entry.contentRect.height);\n\n      if (previous.current.width !== newWidth || previous.current.height !== newHeight) {\n        var newSize = {\n          width: newWidth,\n          height: newHeight\n        };\n\n        if (onResizeRef.current) {\n          onResizeRef.current(newSize);\n        } else {\n          previous.current.width = newWidth;\n          previous.current.height = newHeight;\n          setSize(newSize);\n        }\n      }\n    });\n  }, []);\n  useEffect(function () {\n    if (typeof ref !== \"object\" || ref === null || !(ref.current instanceof Element)) {\n      return;\n    }\n\n    var element = ref.current;\n    resizeObserverRef.current.observe(element);\n    return function () {\n      return resizeObserverRef.current.unobserve(element);\n    };\n  }, [ref]);\n  return useMemo(function () {\n    return {\n      ref: ref,\n      width: size.width,\n      height: size.height\n    };\n  }, [ref, size ? size.width : null, size ? size.height : null]);\n}\n\nexport default useResizeObserver;\n"],"sourceRoot":""}